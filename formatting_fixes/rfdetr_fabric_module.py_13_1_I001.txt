```python
"""
Lightning Fabric implementation for RF-DETR-Mask training with iteration-based approach.
Fabric provides a lightweight alternative to PyTorch Lightning while retaining
key distributed training and mixed precision capabilities.
"""

import datetime
import math
import os
from pathlib import Path

import torch
from lightning.fabric import Fabric
from lightning.fabric.strategies import DDPStrategy
from torch.utils.data import DataLoader, DistributedSampler, RandomSampler, SequentialSampler

# Import autocast for mixed precision training
from torch.amp import autocast  # GradScaler is not directly used

import rfdetr.util.misc as utils
from rfdetr.datasets import build_dataset, get_coco_api_from_dataset
from rfdetr.datasets.coco_eval import CocoEvaluator
from rfdetr.models import build_criterion_and_postprocessors, build_model
from rfdetr.util.get_param_dicts import get_param_dict
from rfdetr.util.utils import ModelEma
```

