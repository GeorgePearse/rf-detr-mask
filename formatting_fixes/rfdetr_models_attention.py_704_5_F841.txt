â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Edit rfdetr/models/attention.py[0m                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Output:[0m                                                             â”‚
â”‚          - in output list :math:`[q', k', v']`, each output tensor will h...[0m â”‚
â”‚              same shape as the corresponding input tensor.[0m                   â”‚
â”‚      """[0m                                                                     â”‚
â”‚ -    embedding_dim = q.size(-1)  # Using descriptive name instead of sing...[0m â”‚
â”‚      if k is v:[0m                                                              â”‚
â”‚          if q is k:[0m                                                          â”‚
â”‚              # self-attention[0m                                                â”‚
â”‚              return F.linear(q, w, b).chunk(3, dim=-1)[0m                       â”‚
â”‚          else:[0m                                                               â”‚
â”‚              # encoder-decoder attention[0m                                     â”‚
â”‚ +            embedding_dim = q.size(-1)  # Using descriptive name instead...[0m â”‚
â”‚              w_q, w_kv = w.split([embedding_dim, embedding_dim * 2])[0m         â”‚
â”‚              if b is None:[0m                                                   â”‚
â”‚                  b_q = b_kv = None[0m                                           â”‚
â”‚              else:[0m                                                           â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

