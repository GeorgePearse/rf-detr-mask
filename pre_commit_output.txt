[INFO] Installing environment for https://github.com/astral-sh/ruff-pre-commit.
[INFO] Once installed this environment will be reused.
[INFO] This may take a few minutes...
[INFO] Installing environment for https://github.com/pre-commit/mirrors-mypy.
[INFO] Once installed this environment will be reused.
[INFO] This may take a few minutes...
[INFO] Installing environment for https://github.com/pre-commit/pre-commit-hooks.
[INFO] Once installed this environment will be reused.
[INFO] This may take a few minutes...
[INFO] Installing environment for https://github.com/pycqa/pydocstyle.
[INFO] Once installed this environment will be reused.
[INFO] This may take a few minutes...
[INFO] Installing environment for https://github.com/asottile/reorder-python-imports.
[INFO] Once installed this environment will be reused.
[INFO] This may take a few minutes...
[INFO] Installing environment for https://github.com/Lucas-C/pre-commit-hooks-safety.
[INFO] Once installed this environment will be reused.
[INFO] This may take a few minutes...
ruff.....................................................................Failed
- hook id: ruff
- exit code: 1
- files were modified by this hook

rfdetr/deploy/_onnx/optimizer.py:319:9: F841 Local variable `n_group_norm_plugin` is assigned to but never used
    |
318 |     def insert_groupnorm_plugin(self):
319 |         n_group_norm_plugin = 0
    |         ^^^^^^^^^^^^^^^^^^^ F841
320 |         for node in self.graph.nodes:
321 |             if (
    |
    = help: Remove assignment to unused variable `n_group_norm_plugin`

rfdetr/deploy/_onnx/optimizer.py:333:17: F841 Local variable `input_tensor` is assigned to but never used
    |
331 |                 # "node.outputs != []" is added for VAE
332 | 
333 |                 input_tensor = node.inputs[0]
    |                 ^^^^^^^^^^^^ F841
334 | 
335 |                 gammaNode = node.o().o().o().o().o().o().o().o().o().o().o()
    |
    = help: Remove assignment to unused variable `input_tensor`

rfdetr/deploy/_onnx/optimizer.py:335:17: N806 Variable `gammaNode` in function should be lowercase
    |
333 |                 input_tensor = node.inputs[0]
334 | 
335 |                 gammaNode = node.o().o().o().o().o().o().o().o().o().o().o()
    |                 ^^^^^^^^^ N806
336 |                 index = [isinstance(i, gs.ir.tensor.Constant) for i in gammaNode.inputs].index(True)
337 |                 gamma = np.array(
    |

rfdetr/deploy/_onnx/optimizer.py:340:17: N806 Variable `constantGamma` in function should be lowercase
    |
338 |                     deepcopy(gammaNode.inputs[index].values.tolist()), dtype=np.float32
339 |                 )
340 |                 constantGamma = gs.Constant(
    |                 ^^^^^^^^^^^^^ N806
341 |                     "groupNormGamma-" + str(nGroupNormPlugin),
342 |                     np.ascontiguousarray(gamma.reshape(-1)),
    |

rfdetr/deploy/_onnx/optimizer.py:341:45: F821 Undefined name `nGroupNormPlugin`
    |
339 |                 )
340 |                 constantGamma = gs.Constant(
341 |                     "groupNormGamma-" + str(nGroupNormPlugin),
    |                                             ^^^^^^^^^^^^^^^^ F821
342 |                     np.ascontiguousarray(gamma.reshape(-1)),
343 |                 )  # MUST use np.ascontiguousarray, or TRT will regard the shape of this Constant as (0) !!!
    |

rfdetr/deploy/_onnx/optimizer.py:345:17: N806 Variable `betaNode` in function should be lowercase
    |
343 |                 )  # MUST use np.ascontiguousarray, or TRT will regard the shape of this Constant as (0) !!!
344 | 
345 |                 betaNode = gammaNode.o()
    |                 ^^^^^^^^ N806
346 |                 index = [isinstance(i, gs.ir.tensor.Constant) for i in betaNode.inputs].index(True)
347 |                 beta = np.array(deepcopy(betaNode.inputs[index].values.tolist()), dtype=np.float32)
    |

rfdetr/deploy/_onnx/optimizer.py:348:17: N806 Variable `constantBeta` in function should be lowercase
    |
346 |                 index = [isinstance(i, gs.ir.tensor.Constant) for i in betaNode.inputs].index(True)
347 |                 beta = np.array(deepcopy(betaNode.inputs[index].values.tolist()), dtype=np.float32)
348 |                 constantBeta = gs.Constant(
    |                 ^^^^^^^^^^^^ N806
349 |                     "groupNormBeta-" + str(nGroupNormPlugin), np.ascontiguousarray(beta.reshape(-1))
350 |                 )
    |

rfdetr/deploy/_onnx/optimizer.py:349:44: F821 Undefined name `nGroupNormPlugin`
    |
347 |                 beta = np.array(deepcopy(betaNode.inputs[index].values.tolist()), dtype=np.float32)
348 |                 constantBeta = gs.Constant(
349 |                     "groupNormBeta-" + str(nGroupNormPlugin), np.ascontiguousarray(beta.reshape(-1))
    |                                            ^^^^^^^^^^^^^^^^ F821
350 |                 )
    |

rfdetr/deploy/_onnx/optimizer.py:355:21: N806 Variable `bSwish` in function should be lowercase
    |
354 |                 if betaNode.o().op == "Sigmoid":  # need Swish
355 |                     bSwish = True
    |                     ^^^^^^ N806
356 |                     lastNode = betaNode.o().o()  # Mul node of Swish
357 |                 else:
    |

rfdetr/deploy/_onnx/optimizer.py:356:21: N806 Variable `lastNode` in function should be lowercase
    |
354 |                 if betaNode.o().op == "Sigmoid":  # need Swish
355 |                     bSwish = True
356 |                     lastNode = betaNode.o().o()  # Mul node of Swish
    |                     ^^^^^^^^ N806
357 |                 else:
358 |                     bSwish = False
    |

rfdetr/deploy/_onnx/optimizer.py:358:21: N806 Variable `bSwish` in function should be lowercase
    |
356 |                     lastNode = betaNode.o().o()  # Mul node of Swish
357 |                 else:
358 |                     bSwish = False
    |                     ^^^^^^ N806
359 |                     lastNode = betaNode  # Cast node after Group Norm
    |

rfdetr/deploy/_onnx/optimizer.py:359:21: N806 Variable `lastNode` in function should be lowercase
    |
357 |                 else:
358 |                     bSwish = False
359 |                     lastNode = betaNode  # Cast node after Group Norm
    |                     ^^^^^^^^ N806
360 | 
361 |                 if lastNode.o().op == "Cast":
    |

rfdetr/deploy/_onnx/optimizer.py:362:21: N806 Variable `lastNode` in function should be lowercase
    |
361 |                 if lastNode.o().op == "Cast":
362 |                     lastNode = lastNode.o()
    |                     ^^^^^^^^ N806
363 |                 inputList = [inputTensor, constantGamma, constantBeta]
364 |                 groupNormV = gs.Variable(
    |

rfdetr/deploy/_onnx/optimizer.py:363:17: N806 Variable `inputList` in function should be lowercase
    |
361 |                 if lastNode.o().op == "Cast":
362 |                     lastNode = lastNode.o()
363 |                 inputList = [inputTensor, constantGamma, constantBeta]
    |                 ^^^^^^^^^ N806
364 |                 groupNormV = gs.Variable(
365 |                     "GroupNormV-" + str(nGroupNormPlugin), np.dtype(np.float16), inputTensor.shape
    |

rfdetr/deploy/_onnx/optimizer.py:363:30: F821 Undefined name `inputTensor`
    |
361 |                 if lastNode.o().op == "Cast":
362 |                     lastNode = lastNode.o()
363 |                 inputList = [inputTensor, constantGamma, constantBeta]
    |                              ^^^^^^^^^^^ F821
364 |                 groupNormV = gs.Variable(
365 |                     "GroupNormV-" + str(nGroupNormPlugin), np.dtype(np.float16), inputTensor.shape
    |

rfdetr/deploy/_onnx/optimizer.py:364:17: N806 Variable `groupNormV` in function should be lowercase
    |
362 |                     lastNode = lastNode.o()
363 |                 inputList = [inputTensor, constantGamma, constantBeta]
364 |                 groupNormV = gs.Variable(
    |                 ^^^^^^^^^^ N806
365 |                     "GroupNormV-" + str(nGroupNormPlugin), np.dtype(np.float16), inputTensor.shape
366 |                 )
    |

rfdetr/deploy/_onnx/optimizer.py:365:41: F821 Undefined name `nGroupNormPlugin`
    |
363 |                 inputList = [inputTensor, constantGamma, constantBeta]
364 |                 groupNormV = gs.Variable(
365 |                     "GroupNormV-" + str(nGroupNormPlugin), np.dtype(np.float16), inputTensor.shape
    |                                         ^^^^^^^^^^^^^^^^ F821
366 |                 )
367 |                 groupNormN = gs.Node(
    |

rfdetr/deploy/_onnx/optimizer.py:365:82: F821 Undefined name `inputTensor`
    |
363 |                 inputList = [inputTensor, constantGamma, constantBeta]
364 |                 groupNormV = gs.Variable(
365 |                     "GroupNormV-" + str(nGroupNormPlugin), np.dtype(np.float16), inputTensor.shape
    |                                                                                  ^^^^^^^^^^^ F821
366 |                 )
367 |                 groupNormN = gs.Node(
    |

rfdetr/deploy/_onnx/optimizer.py:367:17: N806 Variable `groupNormN` in function should be lowercase
    |
365 |                     "GroupNormV-" + str(nGroupNormPlugin), np.dtype(np.float16), inputTensor.shape
366 |                 )
367 |                 groupNormN = gs.Node(
    |                 ^^^^^^^^^^ N806
368 |                     "GroupNorm",
369 |                     "GroupNormN-" + str(nGroupNormPlugin),
    |

rfdetr/deploy/_onnx/optimizer.py:369:41: F821 Undefined name `nGroupNormPlugin`
    |
367 |                 groupNormN = gs.Node(
368 |                     "GroupNorm",
369 |                     "GroupNormN-" + str(nGroupNormPlugin),
    |                                         ^^^^^^^^^^^^^^^^ F821
370 |                     inputs=inputList,
371 |                     outputs=[groupNormV],
    |

rfdetr/deploy/_onnx/optimizer.py:376:21: N806 Variable `subNode` in function should be lowercase
    |
374 |                 self.graph.nodes.append(groupNormN)
375 | 
376 |                 for subNode in self.graph.nodes:
    |                     ^^^^^^^ N806
377 |                     if lastNode.outputs[0] in subNode.inputs:
378 |                         index = subNode.inputs.index(lastNode.outputs[0])
    |

rfdetr/deploy/_onnx/optimizer.py:382:17: N806 Variable `nGroupNormPlugin` in function should be lowercase
    |
380 |                 node.inputs = []
381 |                 lastNode.outputs = []
382 |                 nGroupNormPlugin += 1
    |                 ^^^^^^^^^^^^^^^^ N806
383 | 
384 |         self.cleanup()
    |

rfdetr/deploy/_onnx/optimizer.py:382:17: F821 Undefined name `nGroupNormPlugin`
    |
380 |                 node.inputs = []
381 |                 lastNode.outputs = []
382 |                 nGroupNormPlugin += 1
    |                 ^^^^^^^^^^^^^^^^ F821
383 | 
384 |         self.cleanup()
    |

rfdetr/deploy/_onnx/optimizer.py:388:9: N806 Variable `nLayerNormPlugin` in function should be lowercase
    |
387 |     def insert_layernorm_plugin(self):
388 |         nLayerNormPlugin = 0
    |         ^^^^^^^^^^^^^^^^ N806
389 |         for node in self.graph.nodes:
390 |             if (
    |

rfdetr/deploy/_onnx/optimizer.py:405:17: SIM108 Use ternary operator `inputTensor = node.inputs[0] if node.i().op == "Add" else node.i().inputs[0]` instead of `if`-`else`-block
    |
403 |                   and len(node.o().o(0).o().o().o().o().o().inputs[1].values.shape) == 1
404 |               ):
405 |                   if node.i().op == "Add":
    |  _________________^
406 | |                     inputTensor = node.inputs[0]  # CLIP
407 | |                 else:
408 | |                     inputTensor = node.i().inputs[0]  # UNet and VAE
    | |____________________________________________________^ SIM108
409 |   
410 |                   gammaNode = node.o().o().o().o().o().o().o()
    |
    = help: Replace `if`-`else`-block with `inputTensor = node.inputs[0] if node.i().op == "Add" else node.i().inputs[0]`

rfdetr/deploy/_onnx/optimizer.py:406:21: N806 Variable `inputTensor` in function should be lowercase
    |
404 |             ):
405 |                 if node.i().op == "Add":
406 |                     inputTensor = node.inputs[0]  # CLIP
    |                     ^^^^^^^^^^^ N806
407 |                 else:
408 |                     inputTensor = node.i().inputs[0]  # UNet and VAE
    |

rfdetr/deploy/_onnx/optimizer.py:408:21: N806 Variable `inputTensor` in function should be lowercase
    |
406 |                     inputTensor = node.inputs[0]  # CLIP
407 |                 else:
408 |                     inputTensor = node.i().inputs[0]  # UNet and VAE
    |                     ^^^^^^^^^^^ N806
409 | 
410 |                 gammaNode = node.o().o().o().o().o().o().o()
    |

rfdetr/deploy/_onnx/optimizer.py:410:17: N806 Variable `gammaNode` in function should be lowercase
    |
408 |                     inputTensor = node.i().inputs[0]  # UNet and VAE
409 | 
410 |                 gammaNode = node.o().o().o().o().o().o().o()
    |                 ^^^^^^^^^ N806
411 |                 index = [isinstance(i, gs.ir.tensor.Constant) for i in gammaNode.inputs].index(True)
412 |                 gamma = np.array(
    |

rfdetr/deploy/_onnx/optimizer.py:415:17: N806 Variable `constantGamma` in function should be lowercase
    |
413 |                     deepcopy(gammaNode.inputs[index].values.tolist()), dtype=np.float32
414 |                 )
415 |                 constantGamma = gs.Constant(
    |                 ^^^^^^^^^^^^^ N806
416 |                     "LayerNormGamma-" + str(nLayerNormPlugin),
417 |                     np.ascontiguousarray(gamma.reshape(-1)),
    |

rfdetr/deploy/_onnx/optimizer.py:420:17: N806 Variable `betaNode` in function should be lowercase
    |
418 |                 )  # MUST use np.ascontiguousarray, or TRT will regard the shape of this Constant as (0) !!!
419 | 
420 |                 betaNode = gammaNode.o()
    |                 ^^^^^^^^ N806
421 |                 index = [isinstance(i, gs.ir.tensor.Constant) for i in betaNode.inputs].index(True)
422 |                 beta = np.array(deepcopy(betaNode.inputs[index].values.tolist()), dtype=np.float32)
    |

rfdetr/deploy/_onnx/optimizer.py:423:17: N806 Variable `constantBeta` in function should be lowercase
    |
421 |                 index = [isinstance(i, gs.ir.tensor.Constant) for i in betaNode.inputs].index(True)
422 |                 beta = np.array(deepcopy(betaNode.inputs[index].values.tolist()), dtype=np.float32)
423 |                 constantBeta = gs.Constant(
    |                 ^^^^^^^^^^^^ N806
424 |                     "LayerNormBeta-" + str(nLayerNormPlugin), np.ascontiguousarray(beta.reshape(-1))
425 |                 )
    |

rfdetr/deploy/_onnx/optimizer.py:427:17: N806 Variable `inputList` in function should be lowercase
    |
425 |                 )
426 | 
427 |                 inputList = [inputTensor, constantGamma, constantBeta]
    |                 ^^^^^^^^^ N806
428 |                 layerNormV = gs.Variable(
429 |                     "LayerNormV-" + str(nLayerNormPlugin), np.dtype(np.float32), inputTensor.shape
    |

rfdetr/deploy/_onnx/optimizer.py:428:17: N806 Variable `layerNormV` in function should be lowercase
    |
427 |                 inputList = [inputTensor, constantGamma, constantBeta]
428 |                 layerNormV = gs.Variable(
    |                 ^^^^^^^^^^ N806
429 |                     "LayerNormV-" + str(nLayerNormPlugin), np.dtype(np.float32), inputTensor.shape
430 |                 )
    |

rfdetr/deploy/_onnx/optimizer.py:431:17: N806 Variable `layerNormN` in function should be lowercase
    |
429 |                     "LayerNormV-" + str(nLayerNormPlugin), np.dtype(np.float32), inputTensor.shape
430 |                 )
431 |                 layerNormN = gs.Node(
    |                 ^^^^^^^^^^ N806
432 |                     "LayerNorm",
433 |                     "LayerNormN-" + str(nLayerNormPlugin),
    |

rfdetr/deploy/_onnx/optimizer.py:439:17: N806 Variable `nLayerNormPlugin` in function should be lowercase
    |
437 |                 )
438 |                 self.graph.nodes.append(layerNormN)
439 |                 nLayerNormPlugin += 1
    |                 ^^^^^^^^^^^^^^^^ N806
440 | 
441 |                 if betaNode.outputs[0] in self.graph.outputs:
    |

rfdetr/deploy/_onnx/optimizer.py:445:21: N806 Variable `lastNode` in function should be lowercase
    |
443 |                     self.graph.outputs[index] = layerNormV
444 |                 else:
445 |                     lastNode = betaNode.o() if betaNode.o().op == "Cast" else betaNode
    |                     ^^^^^^^^ N806
446 |                     for subNode in self.graph.nodes:
447 |                         if lastNode.outputs[0] in subNode.inputs:
    |

rfdetr/deploy/_onnx/optimizer.py:446:25: N806 Variable `subNode` in function should be lowercase
    |
444 |                 else:
445 |                     lastNode = betaNode.o() if betaNode.o().op == "Cast" else betaNode
446 |                     for subNode in self.graph.nodes:
    |                         ^^^^^^^ N806
447 |                         if lastNode.outputs[0] in subNode.inputs:
448 |                             index = subNode.inputs.index(lastNode.outputs[0])
    |

rfdetr/deploy/_onnx/optimizer.py:461:9: N806 Variable `C` in function should be lowercase
    |
459 |         weights_v = node_v.inputs[1].values
460 |         # Input number of channels to K and V
461 |         C = weights_k.shape[0]
    |         ^ N806
462 |         # Number of heads
463 |         H = heads
    |

rfdetr/deploy/_onnx/optimizer.py:463:9: N806 Variable `H` in function should be lowercase
    |
461 |         C = weights_k.shape[0]
462 |         # Number of heads
463 |         H = heads
    |         ^ N806
464 |         # Dimension per head
465 |         D = weights_k.shape[1] // H
    |

rfdetr/deploy/_onnx/optimizer.py:465:9: N806 Variable `D` in function should be lowercase
    |
463 |         H = heads
464 |         # Dimension per head
465 |         D = weights_k.shape[1] // H
    |         ^ N806
466 | 
467 |         # Concat and interleave weights such that the output of fused KV GEMM has [b, s_kv, h, 2, d] shape
    |

rfdetr/deploy/_onnx/optimizer.py:582:9: N806 Variable `C` in function should be lowercase
    |
581 |         # Input number of channels to Q, K and V
582 |         C = weights_k.shape[0]
    |         ^ N806
583 |         # Number of heads
584 |         H = heads
    |

rfdetr/deploy/_onnx/optimizer.py:584:9: N806 Variable `H` in function should be lowercase
    |
582 |         C = weights_k.shape[0]
583 |         # Number of heads
584 |         H = heads
    |         ^ N806
585 |         # Hidden dimension per head
586 |         D = weights_k.shape[1] // H
    |

rfdetr/deploy/_onnx/optimizer.py:586:9: N806 Variable `D` in function should be lowercase
    |
584 |         H = heads
585 |         # Hidden dimension per head
586 |         D = weights_k.shape[1] // H
    |         ^ N806
587 | 
588 |         # Concat and interleave weights such that the output of fused QKV GEMM has [b, s, h, 3, d] shape
    |

rfdetr/deploy/benchmark.py:32:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
30 | import tensorrt as trt
31 | import torch
32 | import torchvision.transforms.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ N812
33 | import tqdm
34 | from PIL import Image
   |

rfdetr/deploy/benchmark.py:160:5: N806 Variable `catIds` in function should be lowercase
    |
158 |     self._prepare()
159 |     # loop through images, area range, max detection number
160 |     catIds = p.catIds if p.useCats else [-1]
    |     ^^^^^^ N806
161 | 
162 |     if p.iouType == "segm" or p.iouType == "bbox":
    |

rfdetr/deploy/benchmark.py:163:9: N806 Variable `computeIoU` in function should be lowercase
    |
162 |     if p.iouType == "segm" or p.iouType == "bbox":
163 |         computeIoU = self.computeIoU
    |         ^^^^^^^^^^ N806
164 |     elif p.iouType == "keypoints":
165 |         computeIoU = self.computeOks
    |

rfdetr/deploy/benchmark.py:165:9: N806 Variable `computeIoU` in function should be lowercase
    |
163 |         computeIoU = self.computeIoU
164 |     elif p.iouType == "keypoints":
165 |         computeIoU = self.computeOks
    |         ^^^^^^^^^^ N806
166 |     self.ious = {(imgId, catId): computeIoU(imgId, catId) for imgId in p.imgIds for catId in catIds}
    |

rfdetr/deploy/benchmark.py:168:5: N806 Variable `evaluateImg` in function should be lowercase
    |
166 |     self.ious = {(imgId, catId): computeIoU(imgId, catId) for imgId in p.imgIds for catId in catIds}
167 | 
168 |     evaluateImg = self.evaluateImg
    |     ^^^^^^^^^^^ N806
169 |     maxDet = p.maxDets[-1]
170 |     evalImgs = [
    |

rfdetr/deploy/benchmark.py:169:5: N806 Variable `maxDet` in function should be lowercase
    |
168 |     evaluateImg = self.evaluateImg
169 |     maxDet = p.maxDets[-1]
    |     ^^^^^^ N806
170 |     evalImgs = [
171 |         evaluateImg(imgId, catId, areaRng, maxDet)
    |

rfdetr/deploy/benchmark.py:170:5: N806 Variable `evalImgs` in function should be lowercase
    |
168 |     evaluateImg = self.evaluateImg
169 |     maxDet = p.maxDets[-1]
170 |     evalImgs = [
    |     ^^^^^^^^ N806
171 |         evaluateImg(imgId, catId, areaRng, maxDet)
172 |         for catId in catIds
    |

rfdetr/deploy/benchmark.py:177:5: N806 Variable `evalImgs` in function should be lowercase
    |
175 |     ]
176 |     # this is NOT in the pycocotools code, but could be done outside
177 |     evalImgs = np.asarray(evalImgs).reshape(len(catIds), len(p.areaRng), len(p.imgIds))
    |     ^^^^^^^^ N806
178 |     self._paramsEval = copy.deepcopy(self.params)
179 |     return p.imgIds, evalImgs
    |

rfdetr/deploy/benchmark.py:233:21: F821 Undefined name `box_xyxy_to_cxcywh`
    |
231 |         if "boxes" in target:
232 |             boxes = target["boxes"]
233 |             boxes = box_xyxy_to_cxcywh(boxes)
    |                     ^^^^^^^^^^^^^^^^^^ F821
234 |             boxes = boxes / torch.tensor([w, h, w, h], dtype=torch.float32)
235 |             target["boxes"] = boxes
    |

rfdetr/deploy/benchmark.py:311:62: E741 Ambiguous variable name: `l`
    |
309 |     boxes = boxes * scale_fct[:, None, :]
310 | 
311 |     results = [{"scores": s, "labels": l, "boxes": b} for s, l, b in zip(scores, labels, boxes)]
    |                                                              ^ E741
312 | 
313 |     return results
    |

rfdetr/deploy/benchmark.py:527:9: N806 Variable `EXPLICIT_BATCH` in function should be lowercase
    |
525 |         http://gitlab.baidu.com/paddle-inference/benchmark/blob/main/backend_trt.py#L57
526 |         """
527 |         EXPLICIT_BATCH = 1 << (int)(trt.NetworkDefinitionCreationFlag.EXPLICIT_BATCH)
    |         ^^^^^^^^^^^^^^ N806
528 |         with (
529 |             trt.Builder(self.logger) as builder,
    |

rfdetr/deploy/export.py:26:8: N812 Lowercase `transforms` imported as non-lowercase `T`
   |
24 | from PIL import Image
25 | 
26 | import rfdetr.datasets.transforms as T
   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ N812
27 | import rfdetr.util.misc as utils
28 | from rfdetr.deploy._onnx import OnnxOptimizer
   |

rfdetr/detr.py:17:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
15 | import supervision as sv
16 | import torch
17 | import torchvision.transforms.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ N812
18 | from PIL import Image
   |

rfdetr/detr.py:29:13: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
28 | class RFDETR:
29 |     means = [0.485, 0.456, 0.406]
   |             ^^^^^^^^^^^^^^^^^^^^^ RUF012
30 |     stds = [0.229, 0.224, 0.225]
   |

rfdetr/detr.py:30:12: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
28 | class RFDETR:
29 |     means = [0.485, 0.456, 0.406]
30 |     stds = [0.229, 0.224, 0.225]
   |            ^^^^^^^^^^^^^^^^^^^^^ RUF012
31 | 
32 |     def __init__(self, **kwargs):
   |

rfdetr/engine.py:60:5: C901 `train_one_epoch` is too complex (16 > 10)
   |
60 | def train_one_epoch(
   |     ^^^^^^^^^^^^^^^ C901
61 |     model: torch.nn.Module,
62 |     criterion: torch.nn.Module,
   |

rfdetr/engine.py:118:9: SIM102 Use a single `if` statement instead of nested `if` statements
    |
117 |           # Periodic evaluation during training if enabled
118 |           if (
    |  _________^
119 | |             eval_freq is not None
120 | |             and val_data_loader is not None
121 | |             and base_ds is not None
122 | |             and postprocessors is not None
123 | |         ):
124 | |             if step_counter > 0 and step_counter % eval_freq == 0:
    | |__________________________________________________________________^ SIM102
125 |                   logger.info(f"Running evaluation at step {step_counter}")
126 |                   model.eval()
    |
    = help: Combine `if` statements using `and`

rfdetr/engine.py:229:5: C901 `evaluate` is too complex (17 > 10)
    |
229 | def evaluate(model, criterion, postprocessors, data_loader, base_ds, device, args=None):
    |     ^^^^^^^^ C901
230 |     model.eval()
231 |     if args.fp16_eval:
    |

rfdetr/fabric_module.py:25:27: F401 `torch.amp.GradScaler` imported but unused; consider using `importlib.util.find_spec` to test for availability
   |
23 | # Import autocast for mixed precision training
24 | try:
25 |     from torch.amp import GradScaler, autocast
   |                           ^^^^^^^^^^ F401
26 | 
27 |     DEPRECATED_AMP = False
   |
   = help: Remove unused import

rfdetr/fabric_module.py:25:39: F401 `torch.amp.autocast` imported but unused; consider using `importlib.util.find_spec` to test for availability
   |
23 | # Import autocast for mixed precision training
24 | try:
25 |     from torch.amp import GradScaler, autocast
   |                                       ^^^^^^^^ F401
26 | 
27 |     DEPRECATED_AMP = False
   |
   = help: Remove unused import

rfdetr/fabric_module.py:106:13: F841 Local variable `use_ema` is assigned to but never used
    |
104 |             # Object attribute access
105 |             self.ema_decay = getattr(self.config, "ema_decay", None)
106 |             use_ema = getattr(self.config, "use_ema", True)
    |             ^^^^^^^ F841
107 | 
108 |         self.ema = None  # Will be initialized after model is setup with fabric
    |
    = help: Remove assignment to unused variable `use_ema`

rfdetr/fabric_module.py:308:9: C901 `validation_step` is too complex (11 > 10)
    |
306 |         return metrics
307 | 
308 |     def validation_step(self, batch):
    |         ^^^^^^^^^^^^^^^ C901
309 |         """Execute a single validation step.
    |

rfdetr/fabric_module.py:338:9: SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
    |
337 |           # Forward pass
338 |           with torch.no_grad():
    |  _________^
339 | |             with torch.autocast(**self.autocast_args):
    | |______________________________________________________^ SIM117
340 |                   outputs = model_to_eval(samples)
    |
    = help: Combine `with` statements

rfdetr/fabric_module.py:388:9: C901 `export_model` is too complex (12 > 10)
    |
386 |         return {"metrics": val_metrics, "results": res, "targets": targets}
387 | 
388 |     def export_model(self, epoch):
    |         ^^^^^^^^^^^^ C901
389 |         """Export model to ONNX and save PyTorch weights.
    |

rfdetr/fabric_module.py:578:5: C901 `train_with_fabric` is too complex (20 > 10)
    |
578 | def train_with_fabric(
    |     ^^^^^^^^^^^^^^^^^ C901
579 |     config, output_dir=None, callbacks=None, precision="32-true", devices=1, accelerator="auto"
580 | ):
    |

rfdetr/hooks/onnx_checkpoint_hook.py:104:9: C901 `on_validation_epoch_start` is too complex (18 > 10)
    |
102 |         return nested_tensor
103 | 
104 |     def on_validation_epoch_start(self, trainer, pl_module):
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^ C901
105 |         """
106 |         Called before validation epoch starts.
    |

rfdetr/lightning_module.py:228:9: C901 `validation_step` is too complex (12 > 10)
    |
226 |         return losses
227 | 
228 |     def validation_step(self, batch, batch_idx):
    |         ^^^^^^^^^^^^^^^ C901
229 |         """Validation step logic."""
230 |         try:
    |

rfdetr/lightning_module.py:479:9: C901 `on_validation_epoch_end` is too complex (13 > 10)
    |
477 |                 print(f"Error updating COCO evaluator: {e}")
478 | 
479 |     def on_validation_epoch_end(self):
    |         ^^^^^^^^^^^^^^^^^^^^^^^ C901
480 |         """Process validation epoch results."""
481 |         # Default metric values
    |

rfdetr/lightning_module.py:503:21: SIM102 Use a single `if` statement instead of nested `if` statements
    |
502 |                       # Extract stats
503 |                       if (
    |  _____________________^
504 | |                         "bbox" in self.postprocessors
505 | |                         and hasattr(self.coco_evaluator, "coco_eval")
506 | |                         and "bbox" in self.coco_evaluator.coco_eval
507 | |                     ):
508 | |                         if hasattr(self.coco_evaluator.coco_eval["bbox"], "stats"):
    | |___________________________________________________________________________________^ SIM102
509 |                               stats = self.coco_evaluator.coco_eval["bbox"].stats
510 |                               if hasattr(stats, "tolist"):
    |
    = help: Combine `if` statements using `and`

rfdetr/lightning_module.py:518:21: SIM102 Use a single `if` statement instead of nested `if` statements
    |
516 |                                       self.best_map = map_value
517 |   
518 |                       if (
    |  _____________________^
519 | |                         "segm" in self.postprocessors
520 | |                         and hasattr(self.coco_evaluator, "coco_eval")
521 | |                         and "segm" in self.coco_evaluator.coco_eval
522 | |                     ):
523 | |                         if hasattr(self.coco_evaluator.coco_eval["segm"], "stats"):
    | |___________________________________________________________________________________^ SIM102
524 |                               stats = self.coco_evaluator.coco_eval["segm"].stats
525 |                               if hasattr(stats, "tolist"):
    |
    = help: Combine `if` statements using `and`

rfdetr/lightning_module.py:542:9: C901 `configure_optimizers` is too complex (14 > 10)
    |
540 |             self.log("val/mask_mAP", mask_map_value, on_step=False, on_epoch=True, sync_dist=True)
541 | 
542 |     def configure_optimizers(self):
    |         ^^^^^^^^^^^^^^^^^^^^ C901
543 |         """Configure optimizers and learning rate scheduler for iteration-based training."""
    |

rfdetr/main.py:509:9: F841 Local variable `start_time` is assigned to but never used
    |
508 |         print("Start training")
509 |         start_time = time.time()
    |         ^^^^^^^^^^ F841
510 | 
511 |         # Track best metrics
    |
    = help: Remove assignment to unused variable `start_time`

rfdetr/model_config.py:11:1: UP035 `typing.Dict` is deprecated, use `dict` instead
   |
 9 | """
10 | 
11 | from typing import Any, Dict, List, Literal, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
12 | 
13 | import torch
   |

rfdetr/model_config.py:11:1: UP035 `typing.List` is deprecated, use `list` instead
   |
 9 | """
10 | 
11 | from typing import Any, Dict, List, Literal, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
12 | 
13 | import torch
   |

rfdetr/model_config.py:11:1: UP035 `typing.Tuple` is deprecated, use `tuple` instead
   |
 9 | """
10 | 
11 | from typing import Any, Dict, List, Literal, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
12 | 
13 | import torch
   |

rfdetr/model_config.py:29:26: UP006 Use `list` instead of `List` for type annotation
   |
27 |     # Core model parameters
28 |     encoder: Literal["dinov2_windowed_small", "dinov2_windowed_base", "dinov2_small", "dinov2_base"]
29 |     out_feature_indexes: List[int]
   |                          ^^^^ UP006
30 |     dec_layers: int = Field(default=3, ge=1)
31 |     projector_scale: List[Literal["P3", "P4", "P5", "P6"]]
   |
   = help: Replace with `list`

rfdetr/model_config.py:31:22: UP006 Use `list` instead of `List` for type annotation
   |
29 |     out_feature_indexes: List[int]
30 |     dec_layers: int = Field(default=3, ge=1)
31 |     projector_scale: List[Literal["P3", "P4", "P5", "P6"]]
   |                      ^^^^ UP006
32 |     hidden_dim: int = Field(default=256, gt=0)
   |
   = help: Replace with `list`

rfdetr/model_config.py:69:21: UP006 Use `tuple` instead of `Tuple` for type annotation
   |
67 |     num_classes: int = Field(default=90, gt=0)
68 |     resolution: int = Field(default=560, gt=0)
69 |     shape: Optional[Tuple[int, int]] = None
   |                     ^^^^^ UP006
70 |     dataset_file: Literal["coco", "o365", "roboflow"] = "coco"
71 |     coco_path: str = ""
   |
   = help: Replace with `tuple`

rfdetr/model_config.py:99:36: UP006 Use `list` instead of `List` for type annotation
    |
 97 |     vit_encoder_num_layers: int = Field(default=12, gt=0)
 98 |     pretrained_encoder: bool = True
 99 |     window_block_indexes: Optional[List[int]] = None
    |                                    ^^^^ UP006
100 |     drop_path: float = Field(default=0.0, ge=0.0, le=1.0)
    |
    = help: Replace with `list`

rfdetr/model_config.py:119:29: N805 First argument of a method should be named `self`
    |
118 |     @field_validator("resolution")
119 |     def validate_resolution(cls, v):
    |                             ^^^ N805
120 |         """Validate that resolution is divisible by 14 for DINOv2."""
121 |         if v % 14 != 0:
    |
    = help: Rename `cls` to `self`

rfdetr/model_config.py:125:39: UP006 Use `dict` instead of `Dict` for type annotation
    |
123 |         return v
124 | 
125 |     def dict_for_model_build(self) -> Dict[str, Any]:
    |                                       ^^^^ UP006
126 |         """
127 |         Convert this Pydantic model to a dictionary for backward compatibility
    |
    = help: Replace with `dict`

rfdetr/model_config.py:132:31: UP006 Use `dict` instead of `Dict` for type annotation
    |
130 |         return self.model_dump()
131 | 
132 |     def to_args_dict(self) -> Dict[str, Any]:
    |                               ^^^^ UP006
133 |         """Alias for dict_for_model_build."""
134 |         return self.dict_for_model_build()
    |
    = help: Replace with `dict`

rfdetr/models/attention.py:23:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
21 | import torch
22 | import torch.nn as nn
23 | import torch.nn.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^ N812
24 | from torch import Tensor
25 | from torch.nn.init import constant_, xavier_normal_, xavier_uniform_
   |

rfdetr/models/attention.py:62:21: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
60 |     """
61 | 
62 |     __constants__ = ["batch_first"]
   |                     ^^^^^^^^^^^^^^^ RUF012
63 |     bias_k: Optional[torch.Tensor]
64 |     bias_v: Optional[torch.Tensor]
   |

rfdetr/models/attention.py:273:5: C901 `multi_head_attention_forward` is too complex (28 > 10)
    |
273 | def multi_head_attention_forward(
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ C901
274 |     query: Tensor,
275 |     key: Tensor,
    |

rfdetr/models/attention.py:613:5: N806 Variable `Eq` in function should be lowercase
    |
612 |     """
613 |     Eq, Ek, Ev = q.size(-1), k.size(-1), v.size(-1)
    |     ^^ N806
614 |     assert w_q.shape == (
615 |         Eq,
    |

rfdetr/models/attention.py:613:9: N806 Variable `Ek` in function should be lowercase
    |
612 |     """
613 |     Eq, Ek, Ev = q.size(-1), k.size(-1), v.size(-1)
    |         ^^ N806
614 |     assert w_q.shape == (
615 |         Eq,
    |

rfdetr/models/attention.py:613:13: N806 Variable `Ev` in function should be lowercase
    |
612 |     """
613 |     Eq, Ek, Ev = q.size(-1), k.size(-1), v.size(-1)
    |             ^^ N806
614 |     assert w_q.shape == (
615 |         Eq,
    |

rfdetr/models/attention.py:669:5: N806 Variable `E` in function should be lowercase
    |
667 |             same shape as the corresponding input tensor.
668 |     """
669 |     E = q.size(-1)
    |     ^ N806
670 |     if k is v:
671 |         if q is k:
    |

rfdetr/models/attention.py:723:5: N806 Variable `B` in function should be lowercase
    |
721 |             have shape :math:`(B, Nt, Ns)`
722 |     """
723 |     B, Nt, E = q.shape
    |     ^ N806
724 |     q = q / math.sqrt(E)
725 |     # (B, Nt, E) x (B, E, Ns) -> (B, Nt, Ns)
    |

rfdetr/models/attention.py:723:8: N806 Variable `Nt` in function should be lowercase
    |
721 |             have shape :math:`(B, Nt, Ns)`
722 |     """
723 |     B, Nt, E = q.shape
    |        ^^ N806
724 |     q = q / math.sqrt(E)
725 |     # (B, Nt, E) x (B, E, Ns) -> (B, Nt, Ns)
    |

rfdetr/models/attention.py:723:12: N806 Variable `E` in function should be lowercase
    |
721 |             have shape :math:`(B, Nt, Ns)`
722 |     """
723 |     B, Nt, E = q.shape
    |            ^ N806
724 |     q = q / math.sqrt(E)
725 |     # (B, Nt, E) x (B, E, Ns) -> (B, Nt, Ns)
    |

rfdetr/models/attention.py:747:15: F821 Undefined name `rearrange`
    |
745 |     batch_size, tgt_len, _ = q.size()
746 |     _, src_len, _ = k.size()
747 |     q_unpad = rearrange(q, "b t (h d) -> (b t) h d", h=num_heads)
    |               ^^^^^^^^^ F821
748 |     cu_seqlens_q = torch.arange(
749 |         0, (batch_size + 1) * tgt_len, step=tgt_len, dtype=torch.int32, device=q_unpad.device
    |

rfdetr/models/attention.py:754:16: F821 Undefined name `rearrange`
    |
753 |     def output_pad_fn(output_unpad):
754 |         return rearrange(output_unpad, "(b t) h d -> b t h d", b=batch_size)
    |                ^^^^^^^^^ F821
755 | 
756 |     if key_padding_mask is not None:
    |

rfdetr/models/attention.py:757:58: F821 Undefined name `unpad_input`
    |
756 |     if key_padding_mask is not None:
757 |         k_unpad, indices_k, cu_seqlens_k, max_seqlen_k = unpad_input(k, key_padding_mask)
    |                                                          ^^^^^^^^^^^ F821
758 |         k_unpad = rearrange(k_unpad, "nnz (h d) -> nnz h d", h=num_heads)
759 |         v_unpad, _, _, _ = unpad_input(v, key_padding_mask)
    |

rfdetr/models/attention.py:758:19: F821 Undefined name `rearrange`
    |
756 |     if key_padding_mask is not None:
757 |         k_unpad, indices_k, cu_seqlens_k, max_seqlen_k = unpad_input(k, key_padding_mask)
758 |         k_unpad = rearrange(k_unpad, "nnz (h d) -> nnz h d", h=num_heads)
    |                   ^^^^^^^^^ F821
759 |         v_unpad, _, _, _ = unpad_input(v, key_padding_mask)
760 |         v_unpad = rearrange(v_unpad, "nnz (h d) -> nnz h d", h=num_heads)
    |

rfdetr/models/attention.py:759:28: F821 Undefined name `unpad_input`
    |
757 |         k_unpad, indices_k, cu_seqlens_k, max_seqlen_k = unpad_input(k, key_padding_mask)
758 |         k_unpad = rearrange(k_unpad, "nnz (h d) -> nnz h d", h=num_heads)
759 |         v_unpad, _, _, _ = unpad_input(v, key_padding_mask)
    |                            ^^^^^^^^^^^ F821
760 |         v_unpad = rearrange(v_unpad, "nnz (h d) -> nnz h d", h=num_heads)
761 |     else:
    |

rfdetr/models/attention.py:760:19: F821 Undefined name `rearrange`
    |
758 |         k_unpad = rearrange(k_unpad, "nnz (h d) -> nnz h d", h=num_heads)
759 |         v_unpad, _, _, _ = unpad_input(v, key_padding_mask)
760 |         v_unpad = rearrange(v_unpad, "nnz (h d) -> nnz h d", h=num_heads)
    |                   ^^^^^^^^^ F821
761 |     else:
762 |         k_unpad = rearrange(k, "b s (h d) -> (b s) h d", h=num_heads)
    |

rfdetr/models/attention.py:762:19: F821 Undefined name `rearrange`
    |
760 |         v_unpad = rearrange(v_unpad, "nnz (h d) -> nnz h d", h=num_heads)
761 |     else:
762 |         k_unpad = rearrange(k, "b s (h d) -> (b s) h d", h=num_heads)
    |                   ^^^^^^^^^ F821
763 |         v_unpad = rearrange(v, "b s (h d) -> (b s) h d", h=num_heads)
764 |         cu_seqlens_k = torch.arange(
    |

rfdetr/models/attention.py:763:19: F821 Undefined name `rearrange`
    |
761 |     else:
762 |         k_unpad = rearrange(k, "b s (h d) -> (b s) h d", h=num_heads)
763 |         v_unpad = rearrange(v, "b s (h d) -> (b s) h d", h=num_heads)
    |                   ^^^^^^^^^ F821
764 |         cu_seqlens_k = torch.arange(
765 |             0, (batch_size + 1) * src_len, step=src_len, dtype=torch.int32, device=q_unpad.device
    |

rfdetr/models/backbone/__init__.py:10:1: UP035 `typing.Dict` is deprecated, use `dict` instead
   |
 8 | # ------------------------------------------------------------------------
 9 | 
10 | from typing import Callable, Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
11 | 
12 | import torch
   |

rfdetr/models/backbone/__init__.py:10:1: UP035 `typing.List` is deprecated, use `list` instead
   |
 8 | # ------------------------------------------------------------------------
 9 | 
10 | from typing import Callable, Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
11 | 
12 | import torch
   |

rfdetr/models/backbone/__init__.py:15:1: F403 `from rfdetr.models.backbone.backbone import *` used; unable to detect undefined names
   |
13 | from torch import nn
14 | 
15 | from rfdetr.models.backbone.backbone import *
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ F403
16 | from rfdetr.models.position_encoding import build_position_encoding
17 | from rfdetr.util.misc import NestedTensor
   |

rfdetr/models/backbone/__init__.py:85:16: F405 `Backbone` may be undefined, or defined from star imports
   |
83 |     position_embedding = build_position_encoding(hidden_dim, position_embedding)
84 | 
85 |     backbone = Backbone(
   |                ^^^^^^^^ F405
86 |         encoder,
87 |         pretrained_encoder,
   |

rfdetr/models/backbone/backbone.py:23:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
22 | import torch
23 | import torch.nn.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^ N812
24 | from peft import PeftModel
   |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:301:9: SIM102 Use a single `if` statement instead of nested `if` statements
    |
300 |           # Validate output dimensions if not tracing
301 |           if not torch.jit.is_tracing():
    |  _________^
302 | |             if int(height) != patch_pos_embed.shape[-2] or int(width) != patch_pos_embed.shape[-1]:
    | |___________________________________________________________________________________________________^ SIM102
303 |                   raise ValueError(
304 |                       "Width or height does not match with the interpolated position embeddings"
    |
    = help: Combine `if` statements using `and`

rfdetr/models/backbone/dinov2_with_windowed_attn.py:692:13: N806 Variable `B` in function should be lowercase
    |
690 |         if run_full_attention:
691 |             # reshape x to remove windows
692 |             B, HW, C = hidden_states.shape
    |             ^ N806
693 |             num_windows_squared = self.num_windows**2
694 |             hidden_states = hidden_states.view(
    |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:692:16: N806 Variable `HW` in function should be lowercase
    |
690 |         if run_full_attention:
691 |             # reshape x to remove windows
692 |             B, HW, C = hidden_states.shape
    |                ^^ N806
693 |             num_windows_squared = self.num_windows**2
694 |             hidden_states = hidden_states.view(
    |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:692:20: N806 Variable `C` in function should be lowercase
    |
690 |         if run_full_attention:
691 |             # reshape x to remove windows
692 |             B, HW, C = hidden_states.shape
    |                    ^ N806
693 |             num_windows_squared = self.num_windows**2
694 |             hidden_states = hidden_states.view(
    |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:709:13: N806 Variable `B` in function should be lowercase
    |
707 |         if run_full_attention:
708 |             # reshape x to add windows back
709 |             B, HW, C = hidden_states.shape
    |             ^ N806
710 |             num_windows_squared = self.num_windows**2
711 |             # hidden_states = hidden_states.view(B * num_windows_squared, HW // num_windows_squared, C)
    |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:709:16: N806 Variable `HW` in function should be lowercase
    |
707 |         if run_full_attention:
708 |             # reshape x to add windows back
709 |             B, HW, C = hidden_states.shape
    |                ^^ N806
710 |             num_windows_squared = self.num_windows**2
711 |             # hidden_states = hidden_states.view(B * num_windows_squared, HW // num_windows_squared, C)
    |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:709:20: N806 Variable `C` in function should be lowercase
    |
707 |         if run_full_attention:
708 |             # reshape x to add windows back
709 |             B, HW, C = hidden_states.shape
    |                    ^ N806
710 |             num_windows_squared = self.num_windows**2
711 |             # hidden_states = hidden_states.view(B * num_windows_squared, HW // num_windows_squared, C)
    |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:809:25: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
    |
807 |     main_input_name = "pixel_values"
808 |     supports_gradient_checkpointing = True
809 |     _no_split_modules = ["Dinov2WithRegistersSwiGLUFFN"]
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF012
810 |     _supports_sdpa = True
    |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:1205:25: N806 Variable `B` in function should be lowercase
     |
1203 |                         # undo windowing
1204 |                         num_windows_squared = self.config.num_windows**2
1205 |                         B, HW, C = hidden_state.shape
     |                         ^ N806
1206 |                         num_h_patches_per_window = num_h_patches // self.config.num_windows
1207 |                         num_w_patches_per_window = num_w_patches // self.config.num_windows
     |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:1205:28: N806 Variable `HW` in function should be lowercase
     |
1203 |                         # undo windowing
1204 |                         num_windows_squared = self.config.num_windows**2
1205 |                         B, HW, C = hidden_state.shape
     |                            ^^ N806
1206 |                         num_h_patches_per_window = num_h_patches // self.config.num_windows
1207 |                         num_w_patches_per_window = num_w_patches // self.config.num_windows
     |

rfdetr/models/backbone/dinov2_with_windowed_attn.py:1205:32: N806 Variable `C` in function should be lowercase
     |
1203 |                         # undo windowing
1204 |                         num_windows_squared = self.config.num_windows**2
1205 |                         B, HW, C = hidden_state.shape
     |                                ^ N806
1206 |                         num_h_patches_per_window = num_h_patches // self.config.num_windows
1207 |                         num_w_patches_per_window = num_w_patches // self.config.num_windows
     |

rfdetr/models/backbone/projector.py:20:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
18 | import torch
19 | import torch.nn as nn
20 | import torch.nn.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^ N812
   |

rfdetr/models/lwdetr.py:28:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
27 | import torch
28 | import torch.nn.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^ N812
29 | from torch import nn
   |

rfdetr/models/lwdetr.py:611:9: C901 `forward` is too complex (12 > 10)
    |
609 |         return loss_map[loss](outputs, targets, indices, num_boxes, **kwargs)
610 | 
611 |     def forward(self, outputs, targets):
    |         ^^^^^^^ C901
612 |         """This performs the loss computation.
613 |         Parameters:
    |

rfdetr/models/lwdetr.py:764:20: E741 Ambiguous variable name: `l`
    |
763 |         results = []
764 |         for i, (s, l, b) in enumerate(zip(scores, labels, boxes)):
    |                    ^ E741
765 |             result = {"scores": s, "labels": l, "boxes": b}
    |

rfdetr/models/matcher.py:107:9: N806 Variable `C` in function should be lowercase
    |
106 |         # Final cost matrix
107 |         C = self.cost_bbox * cost_bbox + self.cost_class * cost_class + self.cost_giou * cost_giou
    |         ^ N806
108 |         C = C.view(bs, num_queries, -1).cpu()
    |

rfdetr/models/matcher.py:108:9: N806 Variable `C` in function should be lowercase
    |
106 |         # Final cost matrix
107 |         C = self.cost_bbox * cost_bbox + self.cost_class * cost_class + self.cost_giou * cost_giou
108 |         C = C.view(bs, num_queries, -1).cpu()
    |         ^ N806
109 | 
110 |         sizes = [len(v["boxes"]) for v in targets]
    |

rfdetr/models/matcher.py:113:9: N806 Variable `C_list` in function should be lowercase
    |
111 |         indices = []
112 |         g_num_queries = num_queries // group_detr
113 |         C_list = C.split(g_num_queries, dim=1)
    |         ^^^^^^ N806
114 |         for g_i in range(group_detr):
115 |             C_g = C_list[g_i]
    |

rfdetr/models/matcher.py:115:13: N806 Variable `C_g` in function should be lowercase
    |
113 |         C_list = C.split(g_num_queries, dim=1)
114 |         for g_i in range(group_detr):
115 |             C_g = C_list[g_i]
    |             ^^^ N806
116 |             indices_g = [linear_sum_assignment(c[i]) for i, c in enumerate(C_g.split(sizes, -1))]
117 |             if g_i == 0:
    |

rfdetr/models/ops/functions/ms_deform_attn_func.py:19:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
18 | import torch
19 | import torch.nn.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^ N812
   |

rfdetr/models/ops/functions/ms_deform_attn_func.py:25:5: N806 Variable `B` in function should be lowercase
   |
23 |     """ "for debug and test only, need to use cuda version instead"""
24 |     # B, n_heads, head_dim, N
25 |     B, n_heads, head_dim, _ = value.shape
   |     ^ N806
26 |     _, Len_q, n_heads, L, P, _ = sampling_locations.shape
27 |     value_list = value.split([H * W for H, W in value_spatial_shapes], dim=3)
   |

rfdetr/models/ops/functions/ms_deform_attn_func.py:26:8: N806 Variable `Len_q` in function should be lowercase
   |
24 |     # B, n_heads, head_dim, N
25 |     B, n_heads, head_dim, _ = value.shape
26 |     _, Len_q, n_heads, L, P, _ = sampling_locations.shape
   |        ^^^^^ N806
27 |     value_list = value.split([H * W for H, W in value_spatial_shapes], dim=3)
28 |     sampling_grids = 2 * sampling_locations - 1
   |

rfdetr/models/ops/functions/ms_deform_attn_func.py:26:24: N806 Variable `L` in function should be lowercase
   |
24 |     # B, n_heads, head_dim, N
25 |     B, n_heads, head_dim, _ = value.shape
26 |     _, Len_q, n_heads, L, P, _ = sampling_locations.shape
   |                        ^ N806
27 |     value_list = value.split([H * W for H, W in value_spatial_shapes], dim=3)
28 |     sampling_grids = 2 * sampling_locations - 1
   |

rfdetr/models/ops/functions/ms_deform_attn_func.py:26:27: N806 Variable `P` in function should be lowercase
   |
24 |     # B, n_heads, head_dim, N
25 |     B, n_heads, head_dim, _ = value.shape
26 |     _, Len_q, n_heads, L, P, _ = sampling_locations.shape
   |                           ^ N806
27 |     value_list = value.split([H * W for H, W in value_spatial_shapes], dim=3)
28 |     sampling_grids = 2 * sampling_locations - 1
   |

rfdetr/models/ops/functions/ms_deform_attn_func.py:30:16: N806 Variable `H` in function should be lowercase
   |
28 |     sampling_grids = 2 * sampling_locations - 1
29 |     sampling_value_list = []
30 |     for lid_, (H, W) in enumerate(value_spatial_shapes):
   |                ^ N806
31 |         # B, n_heads, head_dim, H, W
32 |         value_l_ = value_list[lid_].view(B * n_heads, head_dim, H, W)
   |

rfdetr/models/ops/functions/ms_deform_attn_func.py:30:19: N806 Variable `W` in function should be lowercase
   |
28 |     sampling_grids = 2 * sampling_locations - 1
29 |     sampling_value_list = []
30 |     for lid_, (H, W) in enumerate(value_spatial_shapes):
   |                   ^ N806
31 |         # B, n_heads, head_dim, H, W
32 |         value_l_ = value_list[lid_].view(B * n_heads, head_dim, H, W)
   |

rfdetr/models/ops/modules/ms_deform_attn.py:22:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
21 | import torch
22 | import torch.nn.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^ N812
23 | from torch import nn
24 | from torch.nn.init import constant_, xavier_uniform_
   |

rfdetr/models/ops/modules/ms_deform_attn.py:121:9: N806 Variable `N` in function should be lowercase
    |
119 |         :return output                     (N, Length_{query}, C)
120 |         """
121 |         N, Len_q, _ = query.shape
    |         ^ N806
122 |         N, Len_in, _ = input_flatten.shape
123 |         assert (input_spatial_shapes[:, 0] * input_spatial_shapes[:, 1]).sum() == Len_in
    |

rfdetr/models/ops/modules/ms_deform_attn.py:121:12: N806 Variable `Len_q` in function should be lowercase
    |
119 |         :return output                     (N, Length_{query}, C)
120 |         """
121 |         N, Len_q, _ = query.shape
    |            ^^^^^ N806
122 |         N, Len_in, _ = input_flatten.shape
123 |         assert (input_spatial_shapes[:, 0] * input_spatial_shapes[:, 1]).sum() == Len_in
    |

rfdetr/models/ops/modules/ms_deform_attn.py:122:9: N806 Variable `N` in function should be lowercase
    |
120 |         """
121 |         N, Len_q, _ = query.shape
122 |         N, Len_in, _ = input_flatten.shape
    |         ^ N806
123 |         assert (input_spatial_shapes[:, 0] * input_spatial_shapes[:, 1]).sum() == Len_in
    |

rfdetr/models/ops/modules/ms_deform_attn.py:122:12: N806 Variable `Len_in` in function should be lowercase
    |
120 |         """
121 |         N, Len_q, _ = query.shape
122 |         N, Len_in, _ = input_flatten.shape
    |            ^^^^^^ N806
123 |         assert (input_spatial_shapes[:, 0] * input_spatial_shapes[:, 1]).sum() == Len_in
    |

rfdetr/models/position_encoding.py:154:5: N806 Variable `N_steps` in function should be lowercase
    |
153 | def build_position_encoding(hidden_dim, position_embedding):
154 |     N_steps = hidden_dim // 2
    |     ^^^^^^^ N806
155 |     if position_embedding in ("v2", "sine"):
156 |         # TODO find a better way of exposing other arguments
    |

rfdetr/models/segmentation.py:15:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
14 | import torch.nn as nn
15 | import torch.nn.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^ N812
16 | from torch import Tensor
   |

rfdetr/models/segmentation.py:210:12: F821 Undefined name `torch`
    |
209 |         # Check for inf/nan values
210 |         if torch.isnan(mask_probs).any() or torch.isinf(mask_probs).any():
    |            ^^^^^ F821
211 |             print("Warning: inf/nan in mask predictions, clamping values")
212 |             mask_probs = torch.clamp(mask_probs, min=0.0, max=1.0)
    |

rfdetr/models/segmentation.py:210:45: F821 Undefined name `torch`
    |
209 |         # Check for inf/nan values
210 |         if torch.isnan(mask_probs).any() or torch.isinf(mask_probs).any():
    |                                             ^^^^^ F821
211 |             print("Warning: inf/nan in mask predictions, clamping values")
212 |             mask_probs = torch.clamp(mask_probs, min=0.0, max=1.0)
    |

rfdetr/models/segmentation.py:212:26: F821 Undefined name `torch`
    |
210 |         if torch.isnan(mask_probs).any() or torch.isinf(mask_probs).any():
211 |             print("Warning: inf/nan in mask predictions, clamping values")
212 |             mask_probs = torch.clamp(mask_probs, min=0.0, max=1.0)
    |                          ^^^^^ F821
213 | 
214 |         # Add mask predictions to the output
    |

rfdetr/models/transformer.py:24:8: N812 Lowercase `functional` imported as non-lowercase `F`
   |
23 | import torch
24 | import torch.nn.functional as F
   |        ^^^^^^^^^^^^^^^^^^^^^^^^ N812
25 | from torch import Tensor, nn
   |

rfdetr/models/transformer.py:399:9: C901 `forward` is too complex (17 > 10)
    |
397 |         return new_refpoints_unsigmoid
398 | 
399 |     def forward(
    |         ^^^^^^^ C901
400 |         self,
401 |         tgt,
    |

rfdetr/util/benchmark.py:455:5: C901 `flop_count` is too complex (11 > 10)
    |
455 | def flop_count(
    |     ^^^^^^^^^^ C901
456 |     model: nn.Module,
457 |     inputs: tuple[object, ...],
    |

rfdetr/util/early_stopping.py:39:9: C901 `update` is too complex (13 > 10)
   |
37 |         self.model = model
38 | 
39 |     def update(self, log_stats: dict[str, Any]) -> None:
   |         ^^^^^^ C901
40 |         """Update early stopping state based on epoch validation metrics"""
41 |         regular_map = None
   |

rfdetr/util/get_param_dicts.py:90:9: B007 Loop control variable `n` not used within loop body
   |
88 |     # Process other parameters
89 |     other_params = []
90 |     for n, p in all_param_names.items():
   |         ^ B007
91 |         if id(p) not in included_params:
92 |             other_params.append(p)
   |
   = help: Rename unused `n` to `_n`

rfdetr/util/metrics.py:40:9: C901 `save` is too complex (15 > 10)
   |
38 |         self.history.append(values)
39 | 
40 |     def save(self):
   |         ^^^^ C901
41 |         if not self.history:
42 |             print("No data to plot.")
   |

rfdetr/util/metrics.py:177:9: C901 `update` is too complex (12 > 10)
    |
175 |             )
176 | 
177 |     def update(self, values: dict):
    |         ^^^^^^ C901
178 |         if not self.writer:
179 |             return
    |

rfdetr/util/metrics.py:249:9: C901 `update` is too complex (12 > 10)
    |
247 |             )
248 | 
249 |     def update(self, values: dict):
    |         ^^^^^^ C901
250 |         if not wandb or not self.run:
251 |             return
    |

rfdetr/util/misc.py:282:13: SIM113 Use `enumerate()` for index variable `i` in `for` loop
    |
280 |                         )
281 |                     )
282 |             i += 1
    |             ^^^^^^ SIM113
283 |             end = time.time()
284 |         total_time = time.time() - start_time
    |

scripts/evaluate.py:76:5: C901 `evaluate_with_per_class_metrics` is too complex (17 > 10)
   |
76 | def evaluate_with_per_class_metrics(
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ C901
77 |     model, criterion, postprocessors, data_loader, base_ds, device, args=None
78 | ):
   |

scripts/evaluate.py:222:5: C901 `main` is too complex (13 > 10)
    |
222 | def main(args):
    |     ^^^^ C901
223 |     # Setup device
224 |     device = torch.device(args.device if torch.cuda.is_available() else "cpu")
    |

scripts/train.py:36:5: C901 `main` is too complex (15 > 10)
   |
36 | def main():
   |     ^^^^ C901
37 |     """Main training function."""
38 |     parser = argparse.ArgumentParser(description="Train RF-DETR with iteration-based approach")
   |

Found 312 errors (156 fixed, 156 remaining).
No fixes available (15 hidden fixes can be enabled with the `--unsafe-fixes` option).

ruff-format..............................................................Failed
- hook id: ruff-format
- files were modified by this hook

8 files reformatted, 76 files left unchanged

mypy.....................................................................Failed
- hook id: mypy
- exit code: 1

rfdetr/util/obj365_to_coco_model.py:81: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/symbolic.py:21: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/symbolic.py:25: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/symbolic.py:26: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/symbolic.py:27: error: Call to untyped function "optimizer" of "CustomOpSymbolicRegistry" in typed context  [no-untyped-call]
example_custom_annotations.py:10: error: Function is missing a return type annotation  [no-untyped-def]
example_custom_annotations.py:48: error: Function is missing a return type annotation  [no-untyped-def]
example_custom_annotations.py:48: note: Use "-> None" if function does not return a value
example_custom_annotations.py:49: error: Call to untyped function "create_custom_args" in typed context  [no-untyped-call]
example_custom_annotations.py:72: error: Call to untyped function "main" in typed context  [no-untyped-call]
rfdetr/util/logging_config.py:126: error: Incompatible return value type (got "dict[str, object]", expected "dict[str, Handler]")  [return-value]
rfdetr/training_config.py:18: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/training_config.py:206: error: Returning Any from function declared to return "dict[str, Any]"  [no-any-return]
rfdetr/util/error_handling.py:174: error: Name "traceback.TracebackType" is not defined  [name-defined]
rfdetr/util/error_handling.py:187: error: Argument 2 to "log_exception" has incompatible type "BaseException"; expected "Exception"  [arg-type]
rfdetr/util/error_handling.py:190: error: Incompatible types in assignment (expression has type "BaseException", variable has type "Optional[Exception]")  [assignment]
rfdetr/util/drop_scheduler.py:11: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:30: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:34: error: Call to untyped function "set_severity" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:36: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:39: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:46: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:51: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:56: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:61: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:67: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:74: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:81: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:83: error: "str" not callable  [operator]
rfdetr/deploy/_onnx/optimizer.py:84: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:93: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:97: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:185: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:188: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:198: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:201: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:315: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:318: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:341: error: Name "nGroupNormPlugin" is not defined  [name-defined]
rfdetr/deploy/_onnx/optimizer.py:349: error: Name "nGroupNormPlugin" is not defined  [name-defined]
rfdetr/deploy/_onnx/optimizer.py:363: error: Name "inputTensor" is not defined  [name-defined]
rfdetr/deploy/_onnx/optimizer.py:365: error: Name "nGroupNormPlugin" is not defined  [name-defined]
rfdetr/deploy/_onnx/optimizer.py:365: error: Name "inputTensor" is not defined  [name-defined]
rfdetr/deploy/_onnx/optimizer.py:369: error: Name "nGroupNormPlugin" is not defined  [name-defined]
rfdetr/deploy/_onnx/optimizer.py:382: error: Name "nGroupNormPlugin" is not defined  [name-defined]
rfdetr/deploy/_onnx/optimizer.py:384: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:385: error: Name "nGroupNormPlugin" is not defined  [name-defined]
rfdetr/deploy/_onnx/optimizer.py:387: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:452: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:455: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:503: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:506: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:571: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:573: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:628: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:631: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:687: error: Call to untyped function "cleanup" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:689: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:748: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:758: error: Call to untyped function "mha_mhca_detected" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:766: error: Call to untyped function "fuse_kv" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:768: error: Call to untyped function "insert_fmhca" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:772: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:782: error: Call to untyped function "mha_mhca_detected" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:787: error: Call to untyped function "fuse_qkv" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:789: error: Call to untyped function "insert_fmha" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:793: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:795: error: Call to untyped function "fuse_kv_insert_fmhca" in typed context  [no-untyped-call]
rfdetr/deploy/_onnx/optimizer.py:799: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/_onnx/optimizer.py:801: error: Call to untyped function "fuse_qkv_insert_fmha" in typed context  [no-untyped-call]
rfdetr/util/utils.py:12: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/utils.py:25: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/utils.py:32: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/utils.py:41: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/utils.py:42: error: Call to untyped function "_get_decay" in typed context  [no-untyped-call]
rfdetr/util/utils.py:43: error: Call to untyped function "_update" in typed context  [no-untyped-call]
rfdetr/util/utils.py:46: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/utils.py:47: error: Call to untyped function "_update" in typed context  [no-untyped-call]
rfdetr/util/utils.py:51: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/util/utils.py:59: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/utils.py:65: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/utils.py:66: error: Call to untyped function "isbetter" in typed context  [no-untyped-call]
rfdetr/util/utils.py:78: error: Missing type parameters for generic type "dict"  [type-arg]
rfdetr/util/utils.py:86: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/util/utils.py:93: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/utils.py:98: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/util/utils.py:101: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/util/utils.py:102: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/util/utils.py:104: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/util/utils.py:105: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/util/utils.py:107: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/utils.py:118: error: Call to untyped function "summary" in typed context  [no-untyped-call]
rfdetr/util/utils.py:124: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:45: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:48: error: Need type annotation for "deque"  [var-annotated]
rfdetr/util/misc.py:53: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:58: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:58: note: Use "-> None" if function does not return a value
rfdetr/util/misc.py:62: error: Call to untyped function "is_dist_avail_and_initialized" in typed context  [no-untyped-call]
rfdetr/util/misc.py:67: error: Incompatible types in assignment (expression has type "list[Any]", variable has type "Tensor")  [assignment]
rfdetr/util/misc.py:69: error: Incompatible types in assignment (expression has type "Tensor", variable has type "float")  [assignment]
rfdetr/util/misc.py:72: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:77: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:82: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:86: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:90: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:93: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:103: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:111: error: Call to untyped function "get_world_size" in typed context  [no-untyped-call]
rfdetr/util/misc.py:117: error: Call to untyped function "from_buffer" of "TypedStorage" in typed context  [no-untyped-call]
rfdetr/util/misc.py:124: error: List comprehension has incompatible type List[int]; expected List[Tensor]  [misc]
rfdetr/util/misc.py:125: error: Value of type variable "SupportsRichComparisonT" of "max" cannot be "Tensor"  [type-var]
rfdetr/util/misc.py:132: error: Argument 1 to "empty" has incompatible type "tuple[Tensor]"; expected "Sequence[Union[int, SymInt]]"  [arg-type]
rfdetr/util/misc.py:134: error: Argument "size" to "empty" has incompatible type "tuple[Tensor]"; expected "Sequence[Union[int, SymInt]]"  [arg-type]
rfdetr/util/misc.py:146: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:155: error: Call to untyped function "get_world_size" in typed context  [no-untyped-call]
rfdetr/util/misc.py:165: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Any]")  [assignment]
rfdetr/util/misc.py:174: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:184: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:191: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:198: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:204: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:204: note: Use "-> None" if function does not return a value
rfdetr/util/misc.py:208: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:211: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:222: error: Call to untyped function "SmoothedValue" in typed context  [no-untyped-call]
rfdetr/util/misc.py:223: error: Call to untyped function "SmoothedValue" in typed context  [no-untyped-call]
rfdetr/util/misc.py:250: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/util/misc.py:252: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/util/misc.py:256: error: Call to untyped function "is_main_process" in typed context  [no-untyped-call]
rfdetr/util/misc.py:291: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:294: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:301: error: Call to untyped function "_run" in typed context  [no-untyped-call]
rfdetr/util/misc.py:303: error: Call to untyped function "_run" in typed context  [no-untyped-call]
rfdetr/util/misc.py:305: error: Call to untyped function "_run" in typed context  [no-untyped-call]
rfdetr/util/misc.py:312: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:318: error: Name "List" is not defined  [name-defined]
rfdetr/util/misc.py:318: note: Did you forget to import it from "typing"? (Suggestion: "from typing import List")
rfdetr/util/misc.py:328: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/util/misc.py:332: error: Name "Device" is not defined  [name-defined]
rfdetr/util/misc.py:343: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:346: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:350: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:377: error: Untyped decorator makes function "_onnx_nested_tensor_from_tensor_list" untyped  [misc]
rfdetr/util/misc.py:382: error: List comprehension has incompatible type List[int]; expected List[Tensor]  [misc]
rfdetr/util/misc.py:385: error: Incompatible types in assignment (expression has type "tuple[Tensor, ...]", variable has type "list[Tensor]")  [assignment]
rfdetr/util/misc.py:395: error: Argument 2 to "pad" has incompatible type "tuple[int, Tensor, int, Tensor, int, Tensor]"; expected "Sequence[int]"  [arg-type]
rfdetr/util/misc.py:399: error: Argument 2 to "pad" has incompatible type "tuple[int, Tensor, int, Tensor]"; expected "Sequence[int]"  [arg-type]
rfdetr/util/misc.py:408: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:416: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:424: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:430: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:431: error: Call to untyped function "is_dist_avail_and_initialized" in typed context  [no-untyped-call]
rfdetr/util/misc.py:436: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:437: error: Call to untyped function "is_dist_avail_and_initialized" in typed context  [no-untyped-call]
rfdetr/util/misc.py:442: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/misc.py:443: error: Call to untyped function "get_rank" in typed context  [no-untyped-call]
rfdetr/util/misc.py:446: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:450: error: Call to untyped function "is_main_process" in typed context  [no-untyped-call]
rfdetr/util/misc.py:454: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:479: error: Call to untyped function "setup_for_distributed" in typed context  [no-untyped-call]
rfdetr/util/misc.py:483: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:501: error: Name "List" is not defined  [name-defined]
rfdetr/util/misc.py:501: note: Did you forget to import it from "typing"? (Suggestion: "from typing import List")
rfdetr/util/misc.py:510: error: Returning Any from function declared to return "Tensor"  [no-any-return]
rfdetr/util/misc.py:514: error: Returning Any from function declared to return "Tensor"  [no-any-return]
rfdetr/util/misc.py:516: error: Returning Any from function declared to return "Tensor"  [no-any-return]
rfdetr/util/misc.py:519: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/misc.py:526: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/metrics.py:9: error: Cannot assign to a type  [misc]
rfdetr/util/metrics.py:9: error: Incompatible types in assignment (expression has type "None", variable has type "type[SummaryWriter]")  [assignment]
rfdetr/util/metrics.py:21: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/metrics.py:35: error: Need type annotation for "history" (hint: "history: list[<type>] = ...")  [var-annotated]
rfdetr/util/metrics.py:37: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/metrics.py:37: error: Missing type parameters for generic type "dict"  [type-arg]
rfdetr/util/metrics.py:40: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/metrics.py:45: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/metrics.py:48: error: Call to untyped function "get_array" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:49: error: Call to untyped function "get_array" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:50: error: Call to untyped function "get_array" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:55: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:58: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:61: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:68: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:71: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:74: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:166: error: Function "SummaryWriter" could always be true in boolean context  [truthy-function]
rfdetr/util/metrics.py:167: error: Call to untyped function "SummaryWriter" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:172: error: Statement is unreachable  [unreachable]
rfdetr/util/metrics.py:177: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/metrics.py:177: error: Missing type parameters for generic type "dict"  [type-arg]
rfdetr/util/metrics.py:184: error: Call to untyped function "add_scalar" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:186: error: Call to untyped function "add_scalar" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:190: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:191: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:192: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:194: error: Call to untyped function "add_scalar" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:196: error: Call to untyped function "add_scalar" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:198: error: Call to untyped function "add_scalar" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:202: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:203: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:204: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:206: error: Call to untyped function "add_scalar" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:208: error: Call to untyped function "add_scalar" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:210: error: Call to untyped function "add_scalar" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:212: error: Call to untyped function "flush" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:214: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/metrics.py:214: note: Use "-> None" if function does not return a value
rfdetr/util/metrics.py:218: error: Call to untyped function "close" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:237: error: Missing type parameters for generic type "dict"  [type-arg]
rfdetr/util/metrics.py:249: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/metrics.py:249: error: Missing type parameters for generic type "dict"  [type-arg]
rfdetr/util/metrics.py:263: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:264: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:265: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:275: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:276: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:277: error: Call to untyped function "safe_index" in typed context  [no-untyped-call]
rfdetr/util/metrics.py:287: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/metrics.py:287: note: Use "-> None" if function does not return a value
rfdetr/util/box_ops.py:22: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/box_ops.py:33: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/box_ops.py:40: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/box_ops.py:56: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/box_ops.py:67: error: Call to untyped function "box_iou" in typed context  [no-untyped-call]
rfdetr/util/box_ops.py:78: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:45: error: "object" has no attribute "isCompleteTensor"  [attr-defined]
rfdetr/util/benchmark.py:46: error: "object" has no attribute "type"  [attr-defined]
rfdetr/util/benchmark.py:49: error: Returning Any from function declared to return "list[int]"  [no-any-return]
rfdetr/util/benchmark.py:50: error: "object" has no attribute "type"  [attr-defined]
rfdetr/util/benchmark.py:52: error: "object" has no attribute "type"  [attr-defined]
rfdetr/util/benchmark.py:54: error: "object" has no attribute "type"  [attr-defined]
rfdetr/util/benchmark.py:56: error: "object" has no attribute "type"  [attr-defined]
rfdetr/util/benchmark.py:88: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:103: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:113: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:120: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:127: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:135: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:215: error: "object" has no attribute "toIValue"  [attr-defined]
rfdetr/util/benchmark.py:223: error: "object" has no attribute "node"  [attr-defined]
rfdetr/util/benchmark.py:307: error: Incompatible return value type (got "Counter[str]", expected "Number")  [return-value]
rfdetr/util/benchmark.py:327: error: Incompatible return value type (got "Counter[str]", expected "Number")  [return-value]
rfdetr/util/benchmark.py:346: error: Incompatible types in assignment (expression has type "floating[Union[_64Bit, Any]]", variable has type "int")  [assignment]
rfdetr/util/benchmark.py:349: error: Incompatible types in assignment (expression has type "floating[Union[_64Bit, Any]]", variable has type "int")  [assignment]
rfdetr/util/benchmark.py:351: error: Incompatible return value type (got "Counter[str]", expected "Number")  [return-value]
rfdetr/util/benchmark.py:357: error: Missing type parameters for generic type "typing.Callable"  [type-arg]
rfdetr/util/benchmark.py:459: error: Missing type parameters for generic type "typing.Callable"  [type-arg]
rfdetr/util/benchmark.py:505: error: Module "torch.jit" does not explicitly export attribute "_get_trace_graph"  [attr-defined]
rfdetr/util/benchmark.py:505: error: Call to untyped function "_get_trace_graph" in typed context  [no-untyped-call]
rfdetr/util/benchmark.py:508: error: Need type annotation for "skipped_ops"  [var-annotated]
rfdetr/util/benchmark.py:509: error: Need type annotation for "total_flop_counter"  [var-annotated]
rfdetr/util/benchmark.py:523: error: Incompatible types in assignment (expression has type "list[Any]", variable has type "tuple[object, ...]")  [assignment]
rfdetr/util/benchmark.py:541: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:547: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:548: error: Call to untyped function "warmup" in typed context  [no-untyped-call]
rfdetr/util/benchmark.py:557: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:567: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/benchmark.py:591: error: Call to untyped function "measure_time" in typed context  [no-untyped-call]
rfdetr/util/benchmark.py:596: error: Call to untyped function "fmt_res" in typed context  [no-untyped-call]
rfdetr/util/benchmark.py:598: error: Call to untyped function "fmt_res" in typed context  [no-untyped-call]
rfdetr/util/benchmark.py:601: error: Incompatible types in assignment (expression has type "dict[str, Any]", variable has type "defaultdict[str, float]")  [assignment]
rfdetr/util/benchmark.py:601: error: Call to untyped function "fmt_res" in typed context  [no-untyped-call]
rfdetr/models/ops/functions/ms_deform_attn_func.py:43: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Tensor]")  [assignment]
rfdetr/models/backbone/projector.py:31: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:38: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:52: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:67: error: Call to untyped function "LayerNorm" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:72: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:77: error: Incompatible types in assignment (expression has type "ReLU", variable has type "SiLU")  [assignment]
rfdetr/models/backbone/projector.py:79: error: Incompatible types in assignment (expression has type "LeakyReLU", variable has type "SiLU")  [assignment]
rfdetr/models/backbone/projector.py:81: error: Incompatible types in assignment (expression has type "Identity", variable has type "SiLU")  [assignment]
rfdetr/models/backbone/projector.py:90: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:119: error: Call to untyped function "get_norm" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:119: error: Incompatible types in assignment (expression has type "Union[Any, BatchNorm2d]", variable has type "RMSNorm")  [assignment]
rfdetr/models/backbone/projector.py:120: error: Call to untyped function "get_activation" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:122: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:131: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:146: error: Call to untyped function "ConvX" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:147: error: Call to untyped function "ConvX" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:152: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:160: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:166: error: Call to untyped function "ConvX" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:167: error: Call to untyped function "ConvX" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:171: error: Call to untyped function "Bottleneck" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:185: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:198: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:223: error: Need type annotation for "stages_sampling" (hint: "stages_sampling: list[<type>] = ...")  [var-annotated]
rfdetr/models/backbone/projector.py:240: error: Call to untyped function "get_norm" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:266: error: Call to untyped function "ConvX" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:274: error: Incompatible types in assignment (expression has type "Sequential", variable has type "list[Any]")  [assignment]
rfdetr/models/backbone/projector.py:280: error: Call to untyped function "C2f" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:281: error: Call to untyped function "get_norm" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:283: error: Incompatible types in assignment (expression has type "Sequential", variable has type "list[Any]")  [assignment]
rfdetr/models/backbone/projector.py:287: error: Argument 1 to "ModuleList" has incompatible type "list[list[Any]]"; expected "Optional[Iterable[Module]]"  [arg-type]
rfdetr/models/backbone/projector.py:289: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:317: error: Need type annotation for "stage_sampling"  [var-annotated]
rfdetr/models/backbone/projector.py:317: error: Argument 1 to "enumerate" has incompatible type Module; expected "Iterable[Never]"  [arg-type]
rfdetr/models/backbone/projector.py:319: error: Incompatible types in assignment (expression has type "Union[Tensor, Any]", variable has type "list[Any]")  [assignment]
rfdetr/models/backbone/projector.py:327: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/projector.py:330: error: Call to untyped function "ConvX" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:331: error: Call to untyped function "ConvX" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:333: error: Call to untyped function "ConvX" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:334: error: Call to untyped function "ConvX" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:335: error: Call to untyped function "get_norm" in typed context  [no-untyped-call]
rfdetr/models/backbone/projector.py:337: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:50: error: Class cannot subclass "BackboneConfigMixin" (has type "Any")  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:50: error: Class cannot subclass "PretrainedConfig" (has type "Any")  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:130: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:197: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:230: error: Returning Any from function declared to return "Tensor"  [no-any-return]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:248: error: Call to untyped function "Dinov2WithRegistersPatchEmbeddings" in typed context  [no-untyped-call]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:271: error: Module "torch.jit" does not explicitly export attribute "is_tracing"  [attr-defined]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:271: error: Call to untyped function "is_tracing" in typed context  [no-untyped-call]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:301: error: Module "torch.jit" does not explicitly export attribute "is_tracing"  [attr-defined]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:301: error: Call to untyped function "is_tracing" in typed context  [no-untyped-call]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:373: error: Item "None" of "Optional[Parameter]" has no attribute "expand"  [union-attr]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:384: error: Returning Any from function declared to return "Tensor"  [no-any-return]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:413: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:457: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:495: error: Incompatible return value type (got "tuple[Tensor, None]", expected "Union[tuple[Tensor, Tensor], tuple[Tensor]]")  [return-value]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:521: error: Need type annotation for "pruned_heads" (hint: "pruned_heads: set[<type>] = ...")  [var-annotated]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:557: error: Returning Any from function declared to return "Union[tuple[Tensor, Tensor], tuple[Tensor]]"  [no-any-return]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:567: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:605: error: Argument 2 to "drop_path" has incompatible type "Optional[float]"; expected "float"  [arg-type]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:612: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:631: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:644: error: Returning Any from function declared to return "Tensor"  [no-any-return]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:677: error: Incompatible types in assignment (expression has type "Dinov2WithRegistersMLP", variable has type "Dinov2WithRegistersSwiGLUFFN")  [assignment]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:732: error: Returning Any from function declared to return "Union[tuple[Tensor, Tensor], tuple[Tensor]]"  [no-any-return]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:751: error: Missing type parameters for generic type "tuple"  [type-arg]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:757: error: List or tuple expected as variadic arguments  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:768: error: "Tensor" not callable  [operator]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:783: error: List or tuple expected as variadic arguments  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:786: error: List or tuple expected as variadic arguments  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:799: error: Class cannot subclass "PreTrainedModel" (has type "Any")  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:825: error: Statement is unreachable  [unreachable]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:906: error: Item "Tensor" of "Union[Tensor, Module]" has no attribute "prune_heads"  [union-attr]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:906: error: "Tensor" not callable  [operator]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:908: error: Untyped decorator makes function "forward" untyped  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:909: error: Untyped decorator makes function "forward" untyped  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:924: error: Missing type parameters for generic type "tuple"  [type-arg]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:1021: error: Untyped decorator makes function "forward" untyped  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:1022: error: Untyped decorator makes function "forward" untyped  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:1036: error: Missing type parameters for generic type "tuple"  [type-arg]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:1083: error: Incompatible types in assignment (expression has type "CrossEntropyLoss", variable has type "MSELoss")  [assignment]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:1086: error: Incompatible types in assignment (expression has type "BCEWithLogitsLoss", variable has type "MSELoss")  [assignment]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:1108: error: Class cannot subclass "BackboneMixin" (has type "Any")  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:1127: error: Untyped decorator makes function "forward" untyped  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:1128: error: Untyped decorator makes function "forward" untyped  [misc]
rfdetr/models/backbone/dinov2_with_windowed_attn.py:1226: error: Incompatible types in assignment (expression has type "tuple[Any]", variable has type "tuple[()]")  [assignment]
rfdetr/models/backbone/base.py:14: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/base.py:14: note: Use "-> None" if function does not return a value
rfdetr/models/backbone/base.py:17: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/base.py:17: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/attention.py:66: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/attention.py:125: error: Incompatible types in assignment (expression has type "None", variable has type "Parameter")  [assignment]
rfdetr/models/attention.py:126: error: Incompatible types in assignment (expression has type "None", variable has type "Parameter")  [assignment]
rfdetr/models/attention.py:128: error: Incompatible types in assignment (expression has type "None", variable has type "Parameter")  [assignment]
rfdetr/models/attention.py:129: error: Incompatible types in assignment (expression has type "None", variable has type "Parameter")  [assignment]
rfdetr/models/attention.py:130: error: Incompatible types in assignment (expression has type "None", variable has type "Parameter")  [assignment]
rfdetr/models/attention.py:134: error: Call to untyped function "_reset_parameters" in typed context  [no-untyped-call]
rfdetr/models/attention.py:136: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/attention.py:136: note: Use "-> None" if function does not return a value
rfdetr/models/attention.py:153: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/attention.py:158: error: Call to untyped function "__setstate__" in typed context  [no-untyped-call]
rfdetr/models/attention.py:364: error: Subclass of "int" and "Tensor" cannot exist: would have incompatible method signatures  [unreachable]
rfdetr/models/attention.py:366: error: Statement is unreachable  [unreachable]
rfdetr/models/attention.py:372: error: Unsupported operand types for // ("None" and "int")  [operator]
rfdetr/models/attention.py:372: error: Incompatible types in assignment (expression has type "int", variable has type "Tensor")  [assignment]
rfdetr/models/attention.py:492: error: No overload variant of "view" of "TensorBase" matches argument types "int", "int", "int", "Tensor"  [call-overload]
rfdetr/models/attention.py:492: note: Possible overload variants:
rfdetr/models/attention.py:492: note:     def view(self, dtype: dtype) -> Tensor
rfdetr/models/attention.py:492: note:     def view(self, size: Sequence[Union[int, SymInt]]) -> Tensor
rfdetr/models/attention.py:492: note:     def view(self, *size: Union[int, SymInt]) -> Tensor
rfdetr/models/attention.py:554: error: No overload variant of "view" of "TensorBase" matches argument types "int", "int", "Optional[Tensor]"  [call-overload]
rfdetr/models/attention.py:554: note: Possible overload variants:
rfdetr/models/attention.py:554: note:     def view(self, dtype: dtype) -> Tensor
rfdetr/models/attention.py:554: note:     def view(self, size: Sequence[Union[int, SymInt]]) -> Tensor
rfdetr/models/attention.py:554: note:     def view(self, *size: Union[int, SymInt]) -> Tensor
rfdetr/models/attention.py:673: error: Incompatible return value type (got "tuple[Tensor, ...]", expected "list[Tensor]")  [return-value]
rfdetr/models/attention.py:676: error: Call to untyped function "split" in typed context  [no-untyped-call]
rfdetr/models/attention.py:680: error: Call to untyped function "split" in typed context  [no-untyped-call]
rfdetr/models/attention.py:681: error: Incompatible return value type (got "tuple[Tensor, ...]", expected "list[Tensor]")  [return-value]
rfdetr/models/attention.py:688: error: Incompatible return value type (got "tuple[Tensor, Tensor, Tensor]", expected "list[Tensor]")  [return-value]
rfdetr/models/attention.py:737: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/attention.py:747: error: Name "rearrange" is not defined  [name-defined]
rfdetr/models/attention.py:753: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/attention.py:754: error: Name "rearrange" is not defined  [name-defined]
rfdetr/models/attention.py:757: error: Name "unpad_input" is not defined  [name-defined]
rfdetr/models/attention.py:758: error: Name "rearrange" is not defined  [name-defined]
rfdetr/models/attention.py:759: error: Name "unpad_input" is not defined  [name-defined]
rfdetr/models/attention.py:760: error: Name "rearrange" is not defined  [name-defined]
rfdetr/models/attention.py:762: error: Name "rearrange" is not defined  [name-defined]
rfdetr/models/attention.py:763: error: Name "rearrange" is not defined  [name-defined]
rfdetr/model_config.py:21: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/model_config.py:94: error: Incompatible types in assignment (expression has type "str", variable has type "Literal['cpu', 'cuda', 'mps']")  [assignment]
rfdetr/model_config.py:119: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/model_config.py:130: error: Returning Any from function declared to return "dict[str, Any]"  [no-any-return]
rfdetr/deploy/benchmark.py:39: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:52: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:64: error: Need type annotation for "eval_imgs"  [var-annotated]
rfdetr/deploy/benchmark.py:66: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:71: error: Call to untyped function "prepare" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:80: error: Call to untyped function "evaluate" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:84: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:84: note: Use "-> None" if function does not return a value
rfdetr/deploy/benchmark.py:87: error: Call to untyped function "create_common_coco_eval" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:91: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:91: note: Use "-> None" if function does not return a value
rfdetr/deploy/benchmark.py:95: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:95: note: Use "-> None" if function does not return a value
rfdetr/deploy/benchmark.py:100: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:102: error: Call to untyped function "prepare_for_coco_detection" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:106: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:113: error: Call to untyped function "convert_to_xywh" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:131: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:140: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:177: error: Incompatible types in assignment (expression has type "ndarray[Any, dtype[Any]]", variable has type "list[Any]")  [assignment]
rfdetr/deploy/benchmark.py:182: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:187: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:193: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:198: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:201: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:206: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:216: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:221: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:225: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:233: error: Name "box_xyxy_to_cxcywh" is not defined  [name-defined]
rfdetr/deploy/benchmark.py:240: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:244: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:271: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:272: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:272: error: Call to untyped function "Normalize" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:273: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:275: error: Call to untyped function "SquareResize" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:281: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:292: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:303: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:316: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:319: error: Call to untyped function "load_image" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:322: error: Call to untyped function "infer_transforms" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:336: error: Call to untyped function "post_process" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:353: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:356: error: Call to untyped function "load_image" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:359: error: Call to untyped function "infer_transforms" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:376: error: Call to untyped function "post_process" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:395: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/deploy/benchmark.py:410: error: Call to untyped function "load_engine" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:414: error: Call to untyped function "get_bindings" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:419: error: Call to untyped function "get_input_names" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:420: error: Call to untyped function "get_output_names" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:428: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:436: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:442: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:451: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:460: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:473: error: Statement is unreachable  [unreachable]
rfdetr/deploy/benchmark.py:488: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:494: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:502: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:504: error: Call to untyped function "run_sync" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:506: error: Call to untyped function "run_async" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:508: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:508: note: Use "-> None" if function does not return a value
rfdetr/deploy/benchmark.py:516: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:517: error: "None" has no attribute "reset"  [attr-defined]
rfdetr/deploy/benchmark.py:518: error: "None" has no attribute "__enter__"  [attr-defined]
rfdetr/deploy/benchmark.py:518: error: "None" has no attribute "__exit__"  [attr-defined]
rfdetr/deploy/benchmark.py:521: error: "None" has no attribute "total"  [attr-defined]
rfdetr/deploy/benchmark.py:523: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:552: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:552: note: Use "-> None" if function does not return a value
rfdetr/deploy/benchmark.py:557: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:560: error: Call to untyped function "time" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:563: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:564: error: Call to untyped function "time" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:566: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:566: note: Use "-> None" if function does not return a value
rfdetr/deploy/benchmark.py:571: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:579: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/benchmark.py:583: error: Call to untyped function "get_image_list" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:594: error: Call to untyped function "CocoEvaluator" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:596: error: Call to untyped function "TimeProfiler" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:600: error: Call to untyped function "infer_onnx" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:611: error: Call to untyped function "infer_engine" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:627: error: Call to untyped function "parser_args" in typed context  [no-untyped-call]
rfdetr/deploy/benchmark.py:628: error: Call to untyped function "main" in typed context  [no-untyped-call]
rfdetr/config.py:18: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/config.py:33: error: Incompatible types in assignment (expression has type "str", variable has type "Literal['cpu', 'cuda', 'mps']")  [assignment]
rfdetr/config.py:62: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/config.py:97: error: Incompatible types in assignment (expression has type "None", variable has type "list[str]")  [assignment]
rfdetr/models/position_encoding.py:34: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/position_encoding.py:46: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/position_encoding.py:46: note: Use "-> None" if function does not return a value
rfdetr/models/position_encoding.py:49: error: Cannot assign to a method  [method-assign]
rfdetr/models/position_encoding.py:49: error: Incompatible types in assignment (expression has type "Callable[[Tensor, Any], Any]", variable has type "Callable[[NestedTensor, Any], Any]")  [assignment]
rfdetr/models/position_encoding.py:51: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/position_encoding.py:51: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/position_encoding.py:82: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/position_encoding.py:82: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/position_encoding.py:117: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/position_encoding.py:121: error: Call to untyped function "reset_parameters" in typed context  [no-untyped-call]
rfdetr/models/position_encoding.py:124: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/position_encoding.py:124: note: Use "-> None" if function does not return a value
rfdetr/models/position_encoding.py:127: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/position_encoding.py:127: note: Use "-> None" if function does not return a value
rfdetr/models/position_encoding.py:131: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/position_encoding.py:153: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/position_encoding.py:157: error: Call to untyped function "PositionEmbeddingSine" in typed context  [no-untyped-call]
rfdetr/models/position_encoding.py:159: error: Call to untyped function "PositionEmbeddingLearned" in typed context  [no-untyped-call]
rfdetr/models/matcher.py:61: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/matcher.py:92: error: Call to untyped function "generalized_box_iou" in typed context  [no-untyped-call]
rfdetr/models/matcher.py:92: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/models/matcher.py:133: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2.py:42: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2.py:53: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2.py:90: error: Incompatible types in assignment (expression has type "list[int]", variable has type "set[int]")  [assignment]
rfdetr/models/backbone/dinov2.py:92: error: Call to untyped function "get_config" in typed context  [no-untyped-call]
rfdetr/models/backbone/dinov2.py:119: error: Call to untyped function "WindowedDinov2WithRegistersConfig" in typed context  [no-untyped-call]
rfdetr/models/backbone/dinov2.py:126: error: Call to untyped function "WindowedDinov2WithRegistersConfig" in typed context  [no-untyped-call]
rfdetr/models/backbone/dinov2.py:145: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2.py:151: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2.py:182: error: Call to untyped function "make_new_interpolated_pos_encoding" in typed context  [no-untyped-call]
rfdetr/models/backbone/dinov2.py:191: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2.py:203: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/dinov2.py:241: error: Call to untyped function "DinoV2" in typed context  [no-untyped-call]
rfdetr/models/backbone/dinov2.py:242: error: Call to untyped function "export" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:41: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:84: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:103: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:124: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:128: error: Call to untyped function "get_size_with_aspect_ratio" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:131: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:162: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:165: error: Call to untyped function "get_size" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:171: error: Call to untyped function "update_target_for_resize" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:175: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:189: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:192: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:194: error: Call to untyped function "crop" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:202: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:202: error: Missing type parameters for generic type "dict"  [type-arg]
rfdetr/datasets/transforms.py:206: error: Call to untyped function "crop" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:210: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:213: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:218: error: Call to untyped function "crop" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:222: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:225: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:227: error: Call to untyped function "hflip" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:232: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:237: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:239: error: Call to untyped function "resize" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:243: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:247: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:275: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:278: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:281: error: Call to untyped function "pad" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:285: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:290: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:295: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:328: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:331: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:340: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:365: error: Call to untyped function "apply_image" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:372: error: Call to untyped function "apply_bbox" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:386: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:399: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:413: error: Call to untyped function "Pad" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:424: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:429: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:436: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:441: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:444: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:449: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:453: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:461: error: Call to untyped function "box_xyxy_to_cxcywh" in typed context  [no-untyped-call]
rfdetr/datasets/transforms.py:468: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:471: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/transforms.py:476: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:38: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:49: error: Need type annotation for "eval_imgs"  [var-annotated]
rfdetr/datasets/coco_eval.py:51: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:56: error: Call to untyped function "prepare" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:65: error: Call to untyped function "evaluate" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:69: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:69: note: Use "-> None" if function does not return a value
rfdetr/datasets/coco_eval.py:72: error: Call to untyped function "create_common_coco_eval" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:76: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:76: note: Use "-> None" if function does not return a value
rfdetr/datasets/coco_eval.py:80: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:80: note: Use "-> None" if function does not return a value
rfdetr/datasets/coco_eval.py:85: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:87: error: Call to untyped function "prepare_for_coco_detection" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:89: error: Call to untyped function "prepare_for_coco_segmentation" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:91: error: Call to untyped function "prepare_for_coco_keypoint" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:95: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:102: error: Call to untyped function "convert_to_xywh" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:119: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:173: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:180: error: Call to untyped function "convert_to_xywh" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:200: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:205: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:206: error: Call to untyped function "all_gather" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:207: error: Call to untyped function "all_gather" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:217: error: Incompatible types in assignment (expression has type "ndarray[Any, dtype[Any]]", variable has type "list[Any]")  [assignment]
rfdetr/datasets/coco_eval.py:222: error: No overload variant of "__getitem__" of "list" matches argument type "tuple[ellipsis, Any]"  [call-overload]
rfdetr/datasets/coco_eval.py:222: note: Possible overload variants:
rfdetr/datasets/coco_eval.py:222: note:     def __getitem__(self, SupportsIndex, /) -> Any
rfdetr/datasets/coco_eval.py:222: note:     def __getitem__(self, slice, /) -> list[Any]
rfdetr/datasets/coco_eval.py:227: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:228: error: Call to untyped function "merge" in typed context  [no-untyped-call]
rfdetr/datasets/coco_eval.py:243: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/datasets/coco_eval.py:283: error: Incompatible types in assignment (expression has type "ndarray[Any, dtype[Any]]", variable has type "list[Any]")  [assignment]
rfdetr/datasets/fixed_size_transforms.py:32: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/fixed_size_transforms.py:75: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/fixed_size_transforms.py:90: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/fixed_size_transforms.py:92: error: Call to untyped function "Normalize" in typed context  [no-untyped-call]
rfdetr/datasets/fixed_size_transforms.py:96: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/fixed_size_transforms.py:97: error: Call to untyped function "RandomHorizontalFlip" in typed context  [no-untyped-call]
rfdetr/datasets/fixed_size_transforms.py:103: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/fixed_size_transforms.py:111: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/fixed_size_transforms.py:134: error: Call to untyped function "make_fixed_size_transforms" in typed context  [no-untyped-call]
rfdetr/models/ops/modules/ms_deform_attn.py:26: error: Module "rfdetr.models.ops.functions" does not explicitly export attribute "ms_deform_attn_core_pytorch"  [attr-defined]
rfdetr/models/ops/modules/ms_deform_attn.py:53: error: Call to untyped function "_is_power_of_2" in typed context  [no-untyped-call]
rfdetr/models/ops/modules/ms_deform_attn.py:73: error: Call to untyped function "_reset_parameters" in typed context  [no-untyped-call]
rfdetr/models/ops/modules/ms_deform_attn.py:161: error: Call to untyped function "ms_deform_attn_core_pytorch" in typed context  [no-untyped-call]
rfdetr/models/backbone/backbone.py:37: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/backbone/backbone.py:41: error: Missing type parameters for generic type "list"  [type-arg]
rfdetr/models/backbone/backbone.py:44: error: Missing type parameters for generic type "list"  [type-arg]
rfdetr/models/backbone/backbone.py:45: error: Missing type parameters for generic type "list"  [type-arg]
rfdetr/models/backbone/backbone.py:55: error: Call to untyped function "__init__" in typed context  [no-untyped-call]
rfdetr/models/backbone/backbone.py:75: error: Call to untyped function "DinoV2" in typed context  [no-untyped-call]
rfdetr/models/backbone/backbone.py:90: error: Argument 1 to "len" has incompatible type "Optional[list[Any]]"; expected "Sized"  [arg-type]
rfdetr/models/backbone/backbone.py:93: error: Argument 1 to "sorted" has incompatible type "Optional[list[Any]]"; expected "Iterable[Any]"  [arg-type]
rfdetr/models/backbone/backbone.py:98: error: Call to untyped function "MultiScaleProjector" in typed context  [no-untyped-call]
rfdetr/models/backbone/backbone.py:108: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/backbone.py:108: note: Use "-> None" if function does not return a value
rfdetr/models/backbone/backbone.py:111: error: Cannot assign to a method  [method-assign]
rfdetr/models/backbone/backbone.py:111: error: Incompatible types in assignment (expression has type "Callable[[Tensor], Any]", variable has type "Callable[[NestedTensor], Any]")  [assignment]
rfdetr/models/backbone/backbone.py:117: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/backbone.py:131: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/backbone.py:143: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/backbone.py:143: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/backbone/backbone.py:152: error: Call to untyped function "get_dinov2_lr_decay_rate" in typed context  [no-untyped-call]
rfdetr/models/backbone/backbone.py:159: error: Call to untyped function "get_dinov2_weight_decay_rate" in typed context  [no-untyped-call]
rfdetr/models/backbone/backbone.py:168: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/backbone.py:188: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/__init__.py:21: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/__init__.py:25: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/__init__.py:33: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/__init__.py:33: note: Use "-> None" if function does not return a value
rfdetr/models/backbone/__init__.py:36: error: Cannot assign to a method  [method-assign]
rfdetr/models/backbone/__init__.py:36: error: Incompatible types in assignment (expression has type "Callable[[Tensor], Any]", variable has type "Callable[[NestedTensor], Any]")  [assignment]
rfdetr/models/backbone/__init__.py:40: error: Argument 2 to "isinstance" has incompatible type "<typing special form>"; expected "_ClassInfo"  [arg-type]
rfdetr/models/backbone/__init__.py:46: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/backbone/__init__.py:54: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/backbone/__init__.py:83: error: Call to untyped function "build_position_encoding" in typed context  [no-untyped-call]
rfdetr/models/backbone/__init__.py:103: error: Call to untyped function "Joiner" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:33: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco.py:60: error: Class cannot subclass "CocoDetection" (has type "Any")  [misc]
rfdetr/datasets/coco.py:61: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco.py:68: error: Cannot determine type of "ids"  [has-type]
rfdetr/datasets/coco.py:70: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco.py:81: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco.py:93: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Any]")  [assignment]
rfdetr/datasets/coco.py:94: error: No overload variant of "__getitem__" of "list" matches argument type "tuple[slice, slice]"  [call-overload]
rfdetr/datasets/coco.py:94: note: Possible overload variants:
rfdetr/datasets/coco.py:94: note:     def __getitem__(self, SupportsIndex, /) -> Any
rfdetr/datasets/coco.py:94: note:     def __getitem__(self, slice, /) -> list[Any]
rfdetr/datasets/coco.py:94: error: No overload variant of "__setitem__" of "list" matches argument types "tuple[slice, slice]", "Any"  [call-overload]
rfdetr/datasets/coco.py:94: note:     def __setitem__(self, SupportsIndex, Any, /) -> None
rfdetr/datasets/coco.py:94: note:     def __setitem__(self, slice, Iterable[Any], /) -> None
rfdetr/datasets/coco.py:95: error: No overload variant of "__getitem__" of "list" matches argument type "tuple[slice, slice]"  [call-overload]
rfdetr/datasets/coco.py:95: note: Possible overload variants:
rfdetr/datasets/coco.py:95: note:     def __getitem__(self, SupportsIndex, /) -> Any
rfdetr/datasets/coco.py:95: note:     def __getitem__(self, slice, /) -> list[Any]
rfdetr/datasets/coco.py:96: error: No overload variant of "__getitem__" of "list" matches argument type "tuple[slice, slice]"  [call-overload]
rfdetr/datasets/coco.py:96: note: Possible overload variants:
rfdetr/datasets/coco.py:96: note:     def __getitem__(self, SupportsIndex, /) -> Any
rfdetr/datasets/coco.py:96: note:     def __getitem__(self, slice, /) -> list[Any]
rfdetr/datasets/coco.py:99: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Any]")  [assignment]
rfdetr/datasets/coco.py:121: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Any]")  [assignment]
rfdetr/datasets/coco.py:123: error: No overload variant of "__getitem__" of "list" matches argument type "tuple[slice, int]"  [call-overload]
rfdetr/datasets/coco.py:123: note: Possible overload variants:
rfdetr/datasets/coco.py:123: note:     def __getitem__(self, SupportsIndex, /) -> Any
rfdetr/datasets/coco.py:123: note:     def __getitem__(self, slice, /) -> list[Any]
rfdetr/datasets/coco.py:150: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco.py:151: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:154: error: Call to untyped function "Normalize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:161: error: Call to untyped function "compute_multi_scale_scales" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:165: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:167: error: Call to untyped function "RandomHorizontalFlip" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:168: error: Call to untyped function "RandomSelect" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:169: error: Call to untyped function "RandomResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:170: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:172: error: Call to untyped function "RandomResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:174: error: Call to untyped function "RandomResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:183: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:185: error: Call to untyped function "RandomResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:190: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:192: error: Call to untyped function "SquareResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:200: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco.py:205: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:208: error: Call to untyped function "Normalize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:215: error: Call to untyped function "compute_multi_scale_scales" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:219: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:221: error: Call to untyped function "RandomHorizontalFlip" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:222: error: Call to untyped function "RandomSelect" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:223: error: Call to untyped function "SquareResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:224: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:226: error: Call to untyped function "RandomResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:228: error: Call to untyped function "SquareResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:237: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:239: error: Call to untyped function "SquareResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:244: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:246: error: Call to untyped function "SquareResize" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:254: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco.py:295: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:298: error: Call to untyped function "make_coco_transforms_square_div_64" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:307: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:310: error: Call to untyped function "make_coco_transforms" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:321: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/coco.py:338: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:341: error: Call to untyped function "make_coco_transforms_square_div_64" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:347: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
rfdetr/datasets/coco.py:350: error: Call to untyped function "make_coco_transforms" in typed context  [no-untyped-call]
rfdetr/datasets/o365.py:21: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/o365.py:32: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
rfdetr/datasets/o365.py:35: error: Call to untyped function "make_coco_transforms_square_div_64" in typed context  [no-untyped-call]
rfdetr/datasets/o365.py:43: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
rfdetr/datasets/o365.py:46: error: Call to untyped function "make_coco_transforms" in typed context  [no-untyped-call]
rfdetr/datasets/o365.py:56: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/o365.py:58: error: Call to untyped function "build_o365_raw" in typed context  [no-untyped-call]
rfdetr/datasets/o365.py:61: error: Call to untyped function "build_o365_raw" in typed context  [no-untyped-call]
rfdetr/datasets/__init__.py:23: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/__init__.py:31: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/datasets/__init__.py:84: error: Call to untyped function "make_training_dimensions_transforms" in typed context  [no-untyped-call]
rfdetr/datasets/__init__.py:85: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
rfdetr/datasets/__init__.py:89: error: Call to untyped function "build" in typed context  [no-untyped-call]
rfdetr/datasets/__init__.py:91: error: Call to untyped function "build_o365" in typed context  [no-untyped-call]
rfdetr/datasets/__init__.py:93: error: Call to untyped function "build_roboflow" in typed context  [no-untyped-call]
tests/test_resize_div_56.py:43: error: Call to untyped function "build" in typed context  [no-untyped-call]
tests/test_resize_div_56.py:61: error: Call to untyped function "main" in typed context  [no-untyped-call]
tests/test_custom_coco_annotations.py:38: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_custom_coco_annotations.py:58: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_custom_coco_annotations.py:81: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_custom_coco_annotations.py:99: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
rfdetr/util/get_param_dicts.py:14: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/get_param_dicts.py:36: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/util/get_param_dicts.py:50: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/util/get_param_dicts.py:50: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/transformer.py:28: error: Module "rfdetr.models.ops.modules" does not explicitly export attribute "MSDeformAttn"  [attr-defined]
rfdetr/models/transformer.py:34: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:42: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:48: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:77: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:145: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:167: error: Call to untyped function "TransformerDecoderLayer" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:185: error: Call to untyped function (unknown) in typed context  [no-untyped-call]
rfdetr/models/transformer.py:187: error: Call to untyped function "TransformerDecoder" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:204: error: Call to untyped function "MLP" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:207: error: Call to untyped function "_reset_parameters" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:218: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/transformer.py:218: note: Use "-> None" if function does not return a value
rfdetr/models/transformer.py:221: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/transformer.py:221: note: Use "-> None" if function does not return a value
rfdetr/models/transformer.py:227: error: Call to untyped function "_reset_parameters" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:229: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:238: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:240: error: Need type annotation for "mask_flatten"  [var-annotated]
rfdetr/models/transformer.py:243: error: Need type annotation for "valid_ratios"  [var-annotated]
rfdetr/models/transformer.py:255: error: Item "None" of "Optional[list[Any]]" has no attribute "append"  [union-attr]
rfdetr/models/transformer.py:258: error: Incompatible types in assignment (expression has type "Tensor", variable has type "Optional[list[Any]]")  [assignment]
rfdetr/models/transformer.py:259: error: Incompatible types in assignment (expression has type "Tensor", variable has type "Optional[list[Any]]")  [assignment]
rfdetr/models/transformer.py:259: error: Call to untyped function "get_valid_ratio" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:260: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Any]")  [assignment]
rfdetr/models/transformer.py:261: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[tuple[Any, Any]]")  [assignment]
rfdetr/models/transformer.py:263: error: "list[tuple[Any, Any]]" has no attribute "new_zeros"  [attr-defined]
rfdetr/models/transformer.py:263: error: "list[tuple[Any, Any]]" has no attribute "prod"  [attr-defined]
rfdetr/models/transformer.py:267: error: Call to untyped function "gen_encoder_output_proposals" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:318: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Tensor]")  [assignment]
rfdetr/models/transformer.py:320: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Tensor]")  [assignment]
rfdetr/models/transformer.py:321: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Tensor]")  [assignment]
rfdetr/models/transformer.py:327: error: "list[Tensor]" has no attribute "shape"  [attr-defined]
rfdetr/models/transformer.py:332: error: No overload variant of "__getitem__" of "list" matches argument type "tuple[ellipsis, slice]"  [call-overload]
rfdetr/models/transformer.py:332: note: Possible overload variants:
rfdetr/models/transformer.py:332: note:     def __getitem__(self, SupportsIndex, /) -> Tensor
rfdetr/models/transformer.py:332: note:     def __getitem__(self, slice, /) -> list[Tensor]
rfdetr/models/transformer.py:333: error: No overload variant of "__getitem__" of "list" matches argument type "tuple[ellipsis, slice]"  [call-overload]
rfdetr/models/transformer.py:333: note: Possible overload variants:
rfdetr/models/transformer.py:333: note:     def __getitem__(self, SupportsIndex, /) -> Tensor
rfdetr/models/transformer.py:333: note:     def __getitem__(self, slice, /) -> list[Tensor]
rfdetr/models/transformer.py:334: error: No overload variant of "__getitem__" of "list" matches argument type "tuple[ellipsis, slice]"  [call-overload]
rfdetr/models/transformer.py:334: note: Possible overload variants:
rfdetr/models/transformer.py:334: note:     def __getitem__(self, SupportsIndex, /) -> Tensor
rfdetr/models/transformer.py:334: note:     def __getitem__(self, slice, /) -> list[Tensor]
rfdetr/models/transformer.py:351: error: "list[Any]" has no attribute "to"  [attr-defined]
rfdetr/models/transformer.py:359: error: "list[Tensor]" has no attribute "sigmoid"  [attr-defined]
rfdetr/models/transformer.py:363: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:374: error: Call to untyped function "_get_clones" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:382: error: Call to untyped function "MLP" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:386: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/transformer.py:386: note: Use "-> None" if function does not return a value
rfdetr/models/transformer.py:389: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:401: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/transformer.py:401: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/transformer.py:421: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:426: error: Call to untyped function "gen_sineembed_for_position" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:432: error: List item 0 has incompatible type "Optional[Tensor]"; expected "Tensor"  [list-item]
rfdetr/models/transformer.py:432: error: List item 1 has incompatible type "Optional[Tensor]"; expected "Tensor"  [list-item]
rfdetr/models/transformer.py:434: error: Call to untyped function "gen_sineembed_for_position" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:443: error: Call to untyped function "get_reference" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:447: error: Call to untyped function "get_reference" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:448: error: Item "None" of "Optional[Tensor]" has no attribute "sigmoid"  [union-attr]
rfdetr/models/transformer.py:455: error: Call to untyped function "get_reference" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:459: error: Call to untyped function "get_reference" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:460: error: Item "None" of "Optional[Tensor]" has no attribute "sigmoid"  [union-attr]
rfdetr/models/transformer.py:486: error: "Tensor" not callable  [operator]
rfdetr/models/transformer.py:487: error: Call to untyped function "refpoints_refine" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:510: error: Statement is unreachable  [unreachable]
rfdetr/models/transformer.py:516: error: Argument 1 to "stack" has incompatible type "list[Optional[Tensor]]"; expected "Union[tuple[Tensor, ...], list[Tensor], None]"  [arg-type]
rfdetr/models/transformer.py:519: error: Statement is unreachable  [unreachable]
rfdetr/models/transformer.py:525: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:548: error: Call to untyped function "MSDeformAttn" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:565: error: Call to untyped function "_get_activation_fn" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:569: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/transformer.py:569: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/transformer.py:572: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/transformer.py:572: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/transformer.py:627: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/transformer.py:627: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/transformer.py:660: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:664: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/transformer.py:665: error: Call to untyped function "Transformer" in typed context  [no-untyped-call]
rfdetr/models/transformer.py:683: error: Function is missing a type annotation  [no-untyped-def]
modified_coco_build.py:5: error: Module "rfdetr.datasets.transforms" has no attribute "make_coco_transforms"  [attr-defined]
modified_coco_build.py:5: error: Module "rfdetr.datasets.transforms" has no attribute "make_coco_transforms_square_div_64"  [attr-defined]
modified_coco_build.py:8: error: Function is missing a type annotation  [no-untyped-def]
modified_coco_build.py:62: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
modified_coco_build.py:70: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
tests/test_mixed_precision_eval.py:21: error: Call to untyped function "MLP" in typed context  [no-untyped-call]
tests/test_mixed_precision_eval.py:43: error: Call to untyped function "gen_sineembed_for_position" in typed context  [no-untyped-call]
tests/test_mixed_precision_eval.py:55: error: Call to untyped function "gen_sineembed_for_position" in typed context  [no-untyped-call]
tests/test_mixed_precision_eval.py:67: error: Call to untyped function "MLP" in typed context  [no-untyped-call]
tests/test_mixed_precision_eval.py:72: error: Call to untyped function "gen_sineembed_for_position" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:47: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:74: error: Call to untyped function "MLP" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:100: error: Argument 1 to "constant_" has incompatible type "Union[Tensor, Module]"; expected "Tensor"  [arg-type]
rfdetr/models/lwdetr.py:101: error: Argument 1 to "constant_" has incompatible type "Union[Tensor, Module]"; expected "Tensor"  [arg-type]
rfdetr/models/lwdetr.py:104: error: Call to untyped function "MLP" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:105: error: Argument 1 to "constant_" has incompatible type "Union[Tensor, Module]"; expected "Tensor"  [arg-type]
rfdetr/models/lwdetr.py:106: error: Argument 1 to "constant_" has incompatible type "Union[Tensor, Module]"; expected "Tensor"  [arg-type]
rfdetr/models/lwdetr.py:118: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:135: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:135: note: Use "-> None" if function does not return a value
rfdetr/models/lwdetr.py:138: error: Cannot assign to a method  [method-assign]
rfdetr/models/lwdetr.py:138: error: Incompatible types in assignment (expression has type "Callable[[Any], Any]", variable has type "Callable[[NestedTensor, Any], Any]")  [assignment]
rfdetr/models/lwdetr.py:142: error: Argument 2 to "isinstance" has incompatible type "<typing special form>"; expected "_ClassInfo"  [arg-type]
rfdetr/models/lwdetr.py:148: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:148: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/lwdetr.py:219: error: Incompatible types in assignment (expression has type "Tensor", variable has type "list[Any]")  [assignment]
rfdetr/models/lwdetr.py:223: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:249: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:264: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:275: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:288: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:322: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:329: error: Call to untyped function "_get_src_permutation_idx" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:339: error: Call to untyped function "box_iou" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:340: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:341: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:370: error: Call to untyped function "box_iou" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:371: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:372: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:407: error: Call to untyped function "box_iou" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:408: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:409: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:454: error: Call to untyped function "accuracy" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:458: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:471: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:477: error: Call to untyped function "_get_src_permutation_idx" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:487: error: Call to untyped function "generalized_box_iou" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:488: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:494: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:500: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:506: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:512: error: Call to untyped function "_get_src_permutation_idx" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:513: error: Call to untyped function "_get_tgt_permutation_idx" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:601: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:609: error: Cannot call function of unknown type  [operator]
rfdetr/models/lwdetr.py:611: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:628: error: Incompatible types in assignment (expression has type "Tensor", variable has type "int")  [assignment]
rfdetr/models/lwdetr.py:631: error: Call to untyped function "is_dist_avail_and_initialized" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:633: error: Incompatible types in assignment (expression has type "Union[int, float]", variable has type "int")  [assignment]
rfdetr/models/lwdetr.py:633: error: Call to untyped function "get_world_size" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:638: error: Call to untyped function "get_loss" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:649: error: Call to untyped function "get_loss" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:667: error: Call to untyped function "get_loss" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:674: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:674: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/lwdetr.py:702: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:702: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/lwdetr.py:714: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:714: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/lwdetr.py:729: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/lwdetr.py:734: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:755: error: Call to untyped function "box_cxcywh_to_xyxy" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:811: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:816: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:889: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:897: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:903: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:940: error: Call to untyped function "build_backbone" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:992: error: Call to untyped function "build_transformer" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:1006: error: Call to untyped function "LWDETR" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:1010: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/models/lwdetr.py:1012: error: Call to untyped function "build_matcher" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:1041: error: Call to untyped function "SetCriterion" in typed context  [no-untyped-call]
rfdetr/models/lwdetr.py:1057: error: Dict entry 0 has incompatible type "str": "PostProcessSegm"; expected "str": "PostProcess"  [dict-item]
rfdetr/models/lwdetr.py:1057: error: Call to untyped function "PostProcessSegm" in typed context  [no-untyped-call]
rfdetr/models/segmentation.py:105: error: Returning Any from function declared to return "Tensor"  [no-any-return]
rfdetr/models/segmentation.py:131: error: Item "Tensor" of "Union[Tensor, Module]" has no attribute "num_channels"  [union-attr]
rfdetr/models/segmentation.py:132: error: Item "Tensor" of "Union[Tensor, Module]" has no attribute "d_model"  [union-attr]
rfdetr/models/segmentation.py:141: error: Argument "dim" to "MaskHeadSmallConv" has incompatible type "Union[Any, Tensor, Module]"; expected "int"  [arg-type]
rfdetr/models/segmentation.py:141: error: Argument "context_dim" to "MaskHeadSmallConv" has incompatible type "Union[Any, Tensor, Module]"; expected "int"  [arg-type]
rfdetr/models/segmentation.py:147: error: Argument 1 to "Conv2d" has incompatible type "Union[Any, Tensor, Module]"; expected "int"  [arg-type]
rfdetr/models/segmentation.py:147: error: Argument 2 to "Conv2d" has incompatible type "Union[Any, Tensor, Module]"; expected "int"  [arg-type]
rfdetr/models/segmentation.py:148: error: Argument 1 to "Conv2d" has incompatible type "Union[Any, Tensor, Module]"; expected "int"  [arg-type]
rfdetr/models/segmentation.py:148: error: Argument 2 to "Conv2d" has incompatible type "Union[Any, Tensor, Module]"; expected "int"  [arg-type]
rfdetr/models/segmentation.py:149: error: Argument 1 to "Conv2d" has incompatible type "Union[Any, Tensor, Module]"; expected "int"  [arg-type]
rfdetr/models/segmentation.py:149: error: Argument 2 to "Conv2d" has incompatible type "Union[Any, Tensor, Module]"; expected "int"  [arg-type]
rfdetr/models/segmentation.py:153: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/segmentation.py:170: error: "Tensor" not callable  [operator]
rfdetr/models/segmentation.py:178: error: Item "Tensor" of "Union[Tensor, Module]" has no attribute "encoder"  [union-attr]
rfdetr/models/segmentation.py:178: error: "Tensor" not callable  [operator]
rfdetr/models/segmentation.py:210: error: Name "torch" is not defined  [name-defined]
rfdetr/models/segmentation.py:212: error: Name "torch" is not defined  [name-defined]
rfdetr/models/segmentation.py:228: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/models/segmentation.py:228: error: Missing type parameters for generic type "dict"  [type-arg]
rfdetr/models/segmentation.py:243: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
tests/test_checkpoint_loading.py:14: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
tests/test_checkpoint_loading.py:84: error: Call to untyped function "_create_model_config" in typed context  [no-untyped-call]
tests/test_checkpoint_loading.py:85: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
tests/test_checkpoint_loading.py:105: error: Call to untyped function "_create_model_config" in typed context  [no-untyped-call]
tests/test_checkpoint_loading.py:106: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
rfdetr/engine.py:37: error: Module "torch.amp" does not explicitly export attribute "GradScaler"  [attr-defined]
rfdetr/engine.py:37: error: Module "torch.amp" does not explicitly export attribute "autocast"  [attr-defined]
rfdetr/engine.py:41: error: Incompatible import of "GradScaler" (imported name has type "type[torch.cuda.amp.grad_scaler.GradScaler]", local name has type "type[torch.amp.grad_scaler.GradScaler]")  [assignment]
rfdetr/engine.py:41: error: Incompatible import of "autocast" (imported name has type "type[torch.cuda.amp.autocast_mode.autocast]", local name has type "type[torch.amp.autocast_mode.autocast]")  [assignment]
rfdetr/engine.py:46: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/engine.py:60: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/engine.py:60: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/engine.py:64: error: Missing type parameters for generic type "Iterable"  [type-arg]
rfdetr/engine.py:70: error: Incompatible default for argument "ema_m" (default has type "None", argument has type Module)  [assignment]
rfdetr/engine.py:70: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
rfdetr/engine.py:70: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
rfdetr/engine.py:71: error: Missing type parameters for generic type "dict"  [type-arg]
rfdetr/engine.py:75: error: Missing type parameters for generic type "Callable"  [type-arg]
rfdetr/engine.py:79: error: Missing type parameters for generic type "Iterable"  [type-arg]
rfdetr/engine.py:85: error: Call to untyped function "MetricLogger" in typed context  [no-untyped-call]
rfdetr/engine.py:86: error: Call to untyped function "add_meter" in typed context  [no-untyped-call]
rfdetr/engine.py:86: error: Call to untyped function "SmoothedValue" in typed context  [no-untyped-call]
rfdetr/engine.py:87: error: Call to untyped function "add_meter" in typed context  [no-untyped-call]
rfdetr/engine.py:87: error: Call to untyped function "SmoothedValue" in typed context  [no-untyped-call]
rfdetr/engine.py:93: error: Call to untyped function "get_world_size" in typed context  [no-untyped-call]
rfdetr/engine.py:104: error: Argument 1 to "len" has incompatible type "Iterable[Any]"; expected "Sized"  [arg-type]
rfdetr/engine.py:110: error: Call to untyped function "log_every" in typed context  [no-untyped-call]
rfdetr/engine.py:113: error: Unsupported operand types for <= ("int" and "None")  [operator]
rfdetr/engine.py:113: note: Left operand is of type "Optional[int]"
rfdetr/engine.py:124: error: Unsupported operand types for < ("int" and "None")  [operator]
rfdetr/engine.py:124: note: Left operand is of type "Optional[int]"
rfdetr/engine.py:124: error: Unsupported operand types for % ("None" and "int")  [operator]
rfdetr/engine.py:128: error: Call to untyped function "evaluate" in typed context  [no-untyped-call]
rfdetr/engine.py:149: error: Value of type "Optional[defaultdict[str, list[Callable[..., Any]]]]" is not indexable  [index]
rfdetr/engine.py:153: error: Item "Tensor" of "Union[Tensor, Module]" has no attribute "update_drop_path"  [union-attr]
rfdetr/engine.py:153: error: "Tensor" not callable  [operator]
rfdetr/engine.py:155: error: "Tensor" not callable  [operator]
rfdetr/engine.py:158: error: Item "Tensor" of "Union[Tensor, Module]" has no attribute "update_dropout"  [union-attr]
rfdetr/engine.py:158: error: "Tensor" not callable  [operator]
rfdetr/engine.py:160: error: "Tensor" not callable  [operator]
rfdetr/engine.py:163: error: Unsupported operand types for + ("None" and "int")  [operator]
rfdetr/engine.py:163: note: Left operand is of type "Optional[int]"
rfdetr/engine.py:175: error: Call to untyped function "get_autocast_args" in typed context  [no-untyped-call]
rfdetr/engine.py:180: error: Value of type "Union[Tensor, Module]" is not indexable  [index]
rfdetr/engine.py:182: error: Unsupported right operand type for in ("Union[Tensor, Module]")  [operator]
rfdetr/engine.py:185: error: No overload variant of "scale" of "GradScaler" matches argument type "int"  [call-overload]
rfdetr/engine.py:185: note: Possible overload variants:
rfdetr/engine.py:185: note:     def scale(self, outputs: Tensor) -> Tensor
rfdetr/engine.py:185: note:     def scale(self, outputs: list[Tensor]) -> list[Tensor]
rfdetr/engine.py:185: note:     def scale(self, outputs: tuple[Tensor, ...]) -> tuple[Tensor, ...]
rfdetr/engine.py:185: note:     def scale(self, outputs: Iterable[Tensor]) -> Iterable[Tensor]
rfdetr/engine.py:188: error: Call to untyped function "reduce_dict" in typed context  [no-untyped-call]
rfdetr/engine.py:191: error: Value of type "Union[Tensor, Module]" is not indexable  [index]
rfdetr/engine.py:191: error: Unsupported right operand type for in ("Union[Tensor, Module]")  [operator]
rfdetr/engine.py:212: error: "Tensor" not callable  [operator]
rfdetr/engine.py:213: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/engine.py:216: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/engine.py:217: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/engine.py:219: error: Call to untyped function "synchronize_between_processes" in typed context  [no-untyped-call]
rfdetr/engine.py:229: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/engine.py:235: error: Call to untyped function "MetricLogger" in typed context  [no-untyped-call]
rfdetr/engine.py:236: error: Call to untyped function "add_meter" in typed context  [no-untyped-call]
rfdetr/engine.py:236: error: Call to untyped function "SmoothedValue" in typed context  [no-untyped-call]
rfdetr/engine.py:240: error: Call to untyped function "CocoEvaluator" in typed context  [no-untyped-call]
rfdetr/engine.py:242: error: Call to untyped function "log_every" in typed context  [no-untyped-call]
rfdetr/engine.py:250: error: Call to untyped function "get_autocast_args" in typed context  [no-untyped-call]
rfdetr/engine.py:269: error: Call to untyped function "reduce_dict" in typed context  [no-untyped-call]
rfdetr/engine.py:274: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/engine.py:279: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/engine.py:285: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/engine.py:288: error: Call to untyped function "synchronize_between_processes" in typed context  [no-untyped-call]
rfdetr/engine.py:291: error: Call to untyped function "synchronize_between_processes" in typed context  [no-untyped-call]
rfdetr/engine.py:295: error: Call to untyped function "accumulate" in typed context  [no-untyped-call]
rfdetr/engine.py:296: error: Call to untyped function "summarize" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:28: error: Module "rfdetr.deploy._onnx" does not explicitly export attribute "OnnxOptimizer"  [attr-defined]
rfdetr/deploy/export.py:29: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
rfdetr/deploy/export.py:32: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/deploy/export.py:39: error: Incompatible return value type (got "CompletedProcess[str]", expected "int")  [return-value]
rfdetr/deploy/export.py:46: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/export.py:53: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:55: error: Call to untyped function "SquareResize" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:57: error: Call to untyped function "Normalize" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:68: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/export.py:104: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/deploy/export.py:104: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/deploy/export.py:113: error: Call to untyped function "OnnxOptimizer" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:114: error: Call to untyped function "info" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:115: error: Call to untyped function "common_opt" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:116: error: Call to untyped function "info" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:132: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/deploy/export.py:164: error: Call to untyped function "parse_trtexec_output" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:164: error: "int" has no attribute "stdout"  [attr-defined]
rfdetr/deploy/export.py:167: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/export.py:225: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/export.py:231: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/deploy/export.py:232: error: Call to untyped function "get_sha" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:249: error: Call to untyped function "get_rank" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:254: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:271: error: Call to untyped function "no_batch_norm" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:275: error: Call to untyped function "make_infer_image" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:275: error: Missing positional argument "batch_size" in call to "make_infer_image"  [call-arg]
rfdetr/deploy/export.py:294: error: Call to untyped function "export_onnx" in typed context  [no-untyped-call]
rfdetr/deploy/export.py:300: error: "trtexec" does not return a value (it only ever returns None)  [func-returns-value]
rfdetr/main.py:45: error: Module "rfdetr.models" does not explicitly export attribute "build_criterion_and_postprocessors"  [attr-defined]
rfdetr/main.py:45: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
rfdetr/main.py:55: error: Call to untyped function "set_sharing_strategy" in typed context  [no-untyped-call]
rfdetr/main.py:67: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/main.py:67: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/main.py:77: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:79: error: Call to untyped function "_initialize_model_structure" in typed context  [no-untyped-call]
rfdetr/main.py:80: error: Call to untyped function "_load_pretrained_weights" in typed context  [no-untyped-call]
rfdetr/main.py:81: error: Call to untyped function "_apply_lora_if_needed" in typed context  [no-untyped-call]
rfdetr/main.py:82: error: Call to untyped function "_finalize_model_setup" in typed context  [no-untyped-call]
rfdetr/main.py:84: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:87: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
rfdetr/main.py:89: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
rfdetr/main.py:92: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:98: error: Call to untyped function "_load_checkpoint" in typed context  [no-untyped-call]
rfdetr/main.py:105: error: Call to untyped function "_handle_class_mismatch" in typed context  [no-untyped-call]
rfdetr/main.py:108: error: Call to untyped function "_process_exclude_keys" in typed context  [no-untyped-call]
rfdetr/main.py:111: error: Call to untyped function "_process_keys_to_modify" in typed context  [no-untyped-call]
rfdetr/main.py:114: error: Call to untyped function "_update_query_params" in typed context  [no-untyped-call]
rfdetr/main.py:119: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:129: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:138: error: Call to untyped function "reinitialize_detection_head" in typed context  [no-untyped-call]
rfdetr/main.py:140: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:147: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:155: error: Call to untyped function "get_coco_pretrain_from_obj365" in typed context  [no-untyped-call]
rfdetr/main.py:163: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:171: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:195: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:198: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
rfdetr/main.py:200: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:203: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/main.py:203: note: Use "-> None" if function does not return a value
rfdetr/main.py:207: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/main.py:207: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/main.py:207: error: Missing type parameters for generic type "Callable"  [type-arg]
rfdetr/main.py:210: error: Call to untyped function "_validate_callbacks" in typed context  [no-untyped-call]
rfdetr/main.py:212: error: Call to untyped function "_setup_training_environment" in typed context  [no-untyped-call]
rfdetr/main.py:215: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
rfdetr/main.py:216: error: Call to untyped function "_setup_optimizer" in typed context  [no-untyped-call]
rfdetr/main.py:220: error: Call to untyped function "_setup_datasets_and_loaders" in typed context  [no-untyped-call]
rfdetr/main.py:225: error: Call to untyped function "_resume_from_checkpoint" in typed context  [no-untyped-call]
rfdetr/main.py:229: error: Call to untyped function "_run_evaluation" in typed context  [no-untyped-call]
rfdetr/main.py:235: error: Call to untyped function "_setup_drop_schedules" in typed context  [no-untyped-call]
rfdetr/main.py:238: error: Call to untyped function "_run_training_loop" in typed context  [no-untyped-call]
rfdetr/main.py:256: error: Call to untyped function "_save_final_results" in typed context  [no-untyped-call]
rfdetr/main.py:259: error: Call to untyped function "_finalize_model" in typed context  [no-untyped-call]
rfdetr/main.py:265: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:275: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:277: error: Call to untyped function "init_distributed_mode" in typed context  [no-untyped-call]
rfdetr/main.py:278: error: Call to untyped function "get_sha" in typed context  [no-untyped-call]
rfdetr/main.py:283: error: Call to untyped function "get_rank" in typed context  [no-untyped-call]
rfdetr/main.py:296: error: Call to untyped function "convert_sync_batchnorm" of "SyncBatchNorm" in typed context  [no-untyped-call]
rfdetr/main.py:304: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:311: error: Call to untyped function "_create_lr_lambda" in typed context  [no-untyped-call]
rfdetr/main.py:316: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:319: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
rfdetr/main.py:320: error: Call to untyped function "get_world_size" in typed context  [no-untyped-call]
rfdetr/main.py:328: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/main.py:349: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:351: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
rfdetr/main.py:352: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
rfdetr/main.py:356: error: Need type annotation for "sampler_train"  [var-annotated]
rfdetr/main.py:357: error: Need type annotation for "sampler_val"  [var-annotated]
rfdetr/main.py:359: error: Incompatible types in assignment (expression has type "RandomSampler", variable has type "DistributedSampler[Any]")  [assignment]
rfdetr/main.py:360: error: Incompatible types in assignment (expression has type "SequentialSampler", variable has type "DistributedSampler[Any]")  [assignment]
rfdetr/main.py:366: error: Call to untyped function "_create_train_loader" in typed context  [no-untyped-call]
rfdetr/main.py:381: error: Call to untyped function "get_coco_api_from_dataset" in typed context  [no-untyped-call]
rfdetr/main.py:385: error: Call to untyped function "ModelEma" in typed context  [no-untyped-call]
rfdetr/main.py:387: error: Incompatible types in assignment (expression has type "None", variable has type "ModelEma")  [assignment]
rfdetr/main.py:391: error: Call to untyped function "is_main_process" in typed context  [no-untyped-call]
rfdetr/main.py:393: error: Call to untyped function "benchmark" in typed context  [no-untyped-call]
rfdetr/main.py:403: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:436: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:444: error: Call to untyped function "clean_state_dict" in typed context  [no-untyped-call]
rfdetr/main.py:447: error: Call to untyped function "ModelEma" in typed context  [no-untyped-call]
rfdetr/main.py:460: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:464: error: Call to untyped function "evaluate" in typed context  [no-untyped-call]
rfdetr/main.py:469: error: Call to untyped function "save_on_master" in typed context  [no-untyped-call]
rfdetr/main.py:471: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:474: error: Call to untyped function "get_world_size" in typed context  [no-untyped-call]
rfdetr/main.py:483: error: Call to untyped function "drop_scheduler" in typed context  [no-untyped-call]
rfdetr/main.py:499: error: Call to untyped function "drop_scheduler" in typed context  [no-untyped-call]
rfdetr/main.py:515: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:556: error: Call to untyped function "_process_epoch" in typed context  [no-untyped-call]
rfdetr/main.py:580: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:640: error: Call to untyped function "_save_epoch_checkpoints" in typed context  [no-untyped-call]
rfdetr/main.py:645: error: Call to untyped function "_evaluate_model" in typed context  [no-untyped-call]
rfdetr/main.py:650: error: Call to untyped function "_update_regular_model_metrics" in typed context  [no-untyped-call]
rfdetr/main.py:663: error: Call to untyped function "_process_ema_model" in typed context  [no-untyped-call]
rfdetr/main.py:678: error: Call to untyped function "_create_log_stats" in typed context  [no-untyped-call]
rfdetr/main.py:683: error: Call to untyped function "_save_evaluation_logs" in typed context  [no-untyped-call]
rfdetr/main.py:691: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:722: error: Call to untyped function "save_on_master" in typed context  [no-untyped-call]
rfdetr/main.py:724: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:729: error: Call to untyped function "evaluate" in typed context  [no-untyped-call]
rfdetr/main.py:733: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:755: error: Call to untyped function "save_on_master" in typed context  [no-untyped-call]
rfdetr/main.py:768: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:783: error: Call to untyped function "evaluate" in typed context  [no-untyped-call]
rfdetr/main.py:805: error: Call to untyped function "save_on_master" in typed context  [no-untyped-call]
rfdetr/main.py:818: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:851: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:853: error: Call to untyped function "is_main_process" in typed context  [no-untyped-call]
rfdetr/main.py:869: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:871: error: Call to untyped function "is_main_process" in typed context  [no-untyped-call]
rfdetr/main.py:889: error: Call to untyped function "strip_checkpoint" in typed context  [no-untyped-call]
rfdetr/main.py:907: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:917: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/main.py:952: error: Call to untyped function "make_infer_image" in typed context  [no-untyped-call]
rfdetr/main.py:972: error: Call to untyped function "export_onnx" in typed context  [no-untyped-call]
rfdetr/main.py:1400: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/detr.py:32: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/detr.py:33: error: Call to untyped function "get_model_config" in typed context  [no-untyped-call]
rfdetr/detr.py:34: error: Call to untyped function "maybe_download_pretrain_weights" in typed context  [no-untyped-call]
rfdetr/detr.py:38: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/detr.py:38: note: Use "-> None" if function does not return a value
rfdetr/detr.py:41: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/detr.py:44: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/detr.py:45: error: Call to untyped function "get_train_config" in typed context  [no-untyped-call]
rfdetr/detr.py:48: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/detr.py:51: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/detr.py:51: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/detr.py:117: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/detr.py:120: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/detr.py:121: error: Call to untyped function "Model" in typed context  [no-untyped-call]
rfdetr/detr.py:125: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/detr.py:131: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/detr.py:133: error: Missing type parameters for generic type "ndarray"  [type-arg]
rfdetr/detr.py:248: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/detr.py:251: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/detr.py:256: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/detr.py:259: error: Function is missing a type annotation  [no-untyped-def]
tests/trace_masks.py:10: error: Module "rfdetr" does not explicitly export attribute "RFDETRBase"  [attr-defined]
tests/trace_masks.py:25: error: Call to untyped function "RFDETRBase" in typed context  [no-untyped-call]
tests/trace_masks.py:106: error: Call to untyped function "trace_mask_flow" in typed context  [no-untyped-call]
tests/test_segmentation_integration.py:12: error: Module "rfdetr" does not explicitly export attribute "RFDETRBase"  [attr-defined]
tests/test_segmentation_integration.py:16: error: Missing type parameters for generic type "ndarray"  [type-arg]
tests/test_segmentation_integration.py:40: error: Call to untyped function "RFDETRBase" in typed context  [no-untyped-call]
tests/test_segmentation_integration.py:82: error: Call to untyped function "RFDETRBase" in typed context  [no-untyped-call]
tests/test_segmentation_integration.py:139: error: Call to untyped function "RFDETRBase" in typed context  [no-untyped-call]
tests/test_segmentation_integration.py:185: error: Call to untyped function "RFDETRBase" in typed context  [no-untyped-call]
tests/test_segmentation_integration.py:263: error: Call to untyped function (unknown) in typed context  [no-untyped-call]
tests/test_segmentation_integration.py:290: error: Call to untyped function "main" in typed context  [no-untyped-call]
tests/test_minimal_segmentation.py:10: error: Module "rfdetr" does not explicitly export attribute "RFDETRBase"  [attr-defined]
tests/test_minimal_segmentation.py:33: error: Call to untyped function "RFDETRBase" in typed context  [no-untyped-call]
tests/test_minimal_segmentation.py:113: error: Call to untyped function "test_segmentation" in typed context  [no-untyped-call]
tests/test_minimal_model.py:12: error: Module "rfdetr.models" does not explicitly export attribute "build_criterion_and_postprocessors"  [attr-defined]
tests/test_minimal_model.py:12: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
tests/test_minimal_model.py:24: error: Missing type parameters for generic type "list"  [type-arg]
tests/test_minimal_model.py:100: error: "type[TestMinimalModel]" has no attribute "args"  [attr-defined]
tests/test_minimal_model.py:102: error: "type[TestMinimalModel]" has no attribute "model"  [attr-defined]
tests/test_minimal_model.py:102: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
tests/test_minimal_model.py:102: error: "type[TestMinimalModel]" has no attribute "args"  [attr-defined]
tests/test_minimal_model.py:104: error: "type[TestMinimalModel]" has no attribute "model"  [attr-defined]
tests/test_minimal_model.py:105: error: "type[TestMinimalModel]" has no attribute "model"  [attr-defined]
tests/test_minimal_model.py:108: error: "type[TestMinimalModel]" has no attribute "criterion"  [attr-defined]
tests/test_minimal_model.py:108: error: "type[TestMinimalModel]" has no attribute "postprocessors"  [attr-defined]
tests/test_minimal_model.py:108: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
tests/test_minimal_model.py:108: error: "type[TestMinimalModel]" has no attribute "args"  [attr-defined]
tests/test_minimal_model.py:110: error: "type[TestMinimalModel]" has no attribute "criterion"  [attr-defined]
tests/test_minimal_model.py:115: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_minimal_model.py:115: error: "TestMinimalModel" has no attribute "args"  [attr-defined]
tests/test_minimal_model.py:147: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_minimal_model.py:147: error: "TestMinimalModel" has no attribute "args"  [attr-defined]
tests/test_minimal_model.py:153: error: "TestMinimalModel" has no attribute "model"  [attr-defined]
tests/test_minimal_model.py:157: error: "TestMinimalModel" has no attribute "args"  [attr-defined]
tests/test_minimal_model.py:162: error: "TestMinimalModel" has no attribute "model"  [attr-defined]
tests/test_minimal_model.py:172: error: "TestMinimalModel" has no attribute "criterion"  [attr-defined]
tests/test_coco_segmentation.py:32: error: Module "rfdetr.models" does not explicitly export attribute "build_criterion_and_postprocessors"  [attr-defined]
tests/test_coco_segmentation.py:32: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
tests/test_coco_segmentation.py:43: error: "type[TestCocoSegmentation]" has no attribute "coco_path"  [attr-defined]
tests/test_coco_segmentation.py:44: error: "type[TestCocoSegmentation]" has no attribute "coco_path"  [attr-defined]
tests/test_coco_segmentation.py:45: error: Argument 1 to "skipTest" of "TestCase" has incompatible type "type[TestCocoSegmentation]"; expected "TestCase"  [arg-type]
tests/test_coco_segmentation.py:48: error: "type[TestCocoSegmentation]" has no attribute "output_dir"  [attr-defined]
tests/test_coco_segmentation.py:49: error: "type[TestCocoSegmentation]" has no attribute "output_dir"  [attr-defined]
tests/test_coco_segmentation.py:54: error: "TestCocoSegmentation" has no attribute "coco_path"  [attr-defined]
tests/test_coco_segmentation.py:62: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_coco_segmentation.py:82: error: Module "rfdetr.datasets.transforms" has no attribute "ConvertCoco"  [attr-defined]
tests/test_coco_segmentation.py:101: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_coco_segmentation.py:111: error: "TestCocoSegmentation" has no attribute "coco_path"  [attr-defined]
tests/test_coco_segmentation.py:120: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
tests/test_coco_segmentation.py:145: error: "TestCocoSegmentation" has no attribute "coco_path"  [attr-defined]
tests/test_coco_segmentation.py:151: error: "TestCocoSegmentation" has no attribute "output_dir"  [attr-defined]
tests/test_coco_segmentation.py:156: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
tests/test_coco_segmentation.py:157: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
tests/test_coco_segmentation.py:163: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_coco_segmentation.py:169: error: Call to untyped function "get_coco_api_from_dataset" in typed context  [no-untyped-call]
tests/test_coco_segmentation.py:172: error: Call to untyped function "evaluate" in typed context  [no-untyped-call]
tests/test_coco_segmentation.py:187: error: Module "torch.multiprocessing" does not explicitly export attribute "spawn"  [attr-defined]
tests/test_coco_segmentation.py:187: error: Call to untyped function "spawn" in typed context  [no-untyped-call]
tests/debug_segmentation.py:9: error: Module "rfdetr" does not explicitly export attribute "RFDETRBase"  [attr-defined]
tests/debug_segmentation.py:24: error: Call to untyped function "RFDETRBase" in typed context  [no-untyped-call]
tests/debug_segmentation.py:104: error: Call to untyped function "debug_model_outputs" in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:181: error: Call to untyped function "Compose" in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:183: error: Call to untyped function "RandomResize" in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:184: error: Call to untyped function "Normalize" in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:189: error: Call to untyped function "CocoDetection" in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:207: error: Call to untyped function (unknown) in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:220: error: Cannot assign to a method  [method-assign]
tests/check_coco_mask_loading.py:231: error: Call to untyped function "examine_original_annotations" in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:239: error: Call to untyped function "visualize_masks" in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:265: error: Cannot assign to a method  [method-assign]
tests/check_coco_mask_loading.py:350: error: Call to untyped function "parse_args" in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:351: error: Call to untyped function "convert_coco_check" in typed context  [no-untyped-call]
tests/check_coco_mask_loading.py:352: error: Call to untyped function "suggest_coco_fix" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:26: error: Module "rfdetr.models" does not explicitly export attribute "build_criterion_and_postprocessors"  [attr-defined]
rfdetr/lightning_module.py:26: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
rfdetr/lightning_module.py:31: error: Class cannot subclass "LightningModule" (has type "Any")  [misc]
rfdetr/lightning_module.py:34: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:53: error: Incompatible types in assignment (expression has type "dict[Any, Any]", variable has type "ModelConfig")  [assignment]
rfdetr/lightning_module.py:62: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:63: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:70: error: Statement is unreachable  [unreachable]
rfdetr/lightning_module.py:79: error: Call to untyped function "ModelEma" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:87: error: Call to untyped function "_setup_autocast_args" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:121: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/lightning_module.py:121: note: Use "-> None" if function does not return a value
rfdetr/lightning_module.py:156: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:160: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:176: error: Call to untyped function "reduce_dict" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:214: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:228: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:277: error: Call to untyped function "reduce_dict" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:318: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:351: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:432: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/lightning_module.py:432: note: Use "-> None" if function does not return a value
rfdetr/lightning_module.py:443: error: Call to untyped function "get_coco_api_from_dataset" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:446: error: Call to untyped function "CocoEvaluator" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:449: error: Incompatible types in assignment (expression has type "None", variable has type "CocoEvaluator")  [assignment]
rfdetr/lightning_module.py:452: error: Incompatible types in assignment (expression has type "None", variable has type "CocoEvaluator")  [assignment]
rfdetr/lightning_module.py:457: error: Incompatible types in assignment (expression has type "None", variable has type "CocoEvaluator")  [assignment]
rfdetr/lightning_module.py:463: error: Call to untyped function "export_model" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:468: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:475: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:479: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/lightning_module.py:479: note: Use "-> None" if function does not return a value
rfdetr/lightning_module.py:496: error: Call to untyped function "synchronize_between_processes" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:499: error: Call to untyped function "accumulate" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:500: error: Call to untyped function "summarize" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:542: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/lightning_module.py:549: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:599: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/lightning_module.py:632: error: Class cannot subclass "LightningDataModule" (has type "Any")  [misc]
rfdetr/lightning_module.py:635: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:652: error: Incompatible types in assignment (expression has type "dict[Any, Any]", variable has type "ModelConfig")  [assignment]
rfdetr/lightning_module.py:670: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/lightning_module.py:673: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:676: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
rfdetr/lightning_module.py:680: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/lightning_module.py:683: error: Need type annotation for "sampler_train"  [var-annotated]
rfdetr/lightning_module.py:685: error: Incompatible types in assignment (expression has type "RandomSampler", variable has type "DistributedSampler[Any]")  [assignment]
rfdetr/lightning_module.py:700: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/lightning_module.py:703: error: Need type annotation for "sampler_val"  [var-annotated]
rfdetr/lightning_module.py:705: error: Incompatible types in assignment (expression has type "SequentialSampler", variable has type "DistributedSampler[Any]")  [assignment]
rfdetr/hooks/onnx_checkpoint_hook.py:25: error: Module "rfdetr.deploy._onnx" does not explicitly export attribute "OnnxOptimizer"  [attr-defined]
rfdetr/hooks/onnx_checkpoint_hook.py:33: error: Class cannot subclass "Callback" (has type "Any")  [misc]
rfdetr/hooks/onnx_checkpoint_hook.py:41: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/hooks/onnx_checkpoint_hook.py:72: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/hooks/onnx_checkpoint_hook.py:104: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/hooks/onnx_checkpoint_hook.py:202: error: Call to untyped function "_make_dummy_input" in typed context  [no-untyped-call]
rfdetr/hooks/onnx_checkpoint_hook.py:239: error: Call to untyped function "OnnxOptimizer" in typed context  [no-untyped-call]
rfdetr/hooks/onnx_checkpoint_hook.py:240: error: Call to untyped function "common_opt" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:25: error: Module "torch.amp" does not explicitly export attribute "GradScaler"  [attr-defined]
rfdetr/fabric_module.py:25: error: Module "torch.amp" does not explicitly export attribute "autocast"  [attr-defined]
rfdetr/fabric_module.py:34: error: Module "rfdetr.models" does not explicitly export attribute "build_criterion_and_postprocessors"  [attr-defined]
rfdetr/fabric_module.py:34: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
rfdetr/fabric_module.py:39: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:70: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:86: error: Incompatible types in assignment (expression has type "dict[Any, Any]", variable has type "ModelConfig")  [assignment]
rfdetr/fabric_module.py:95: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:96: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:116: error: Call to untyped function "_setup_autocast_args" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:147: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/fabric_module.py:147: note: Use "-> None" if function does not return a value
rfdetr/fabric_module.py:150: error: Call to untyped function "get_autocast_args" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:152: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:178: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:190: error: Call to untyped function "ModelEma" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:212: error: Call to untyped function "_setup_lr_scheduler" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:214: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/fabric_module.py:230: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/fabric_module.py:252: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:290: error: Call to untyped function "reduce_dict" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:308: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:370: error: Call to untyped function "reduce_dict" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:388: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:446: error: Call to untyped function "_make_dummy_input" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:450: error: Call to untyped function "export_onnx" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:450: error: Missing positional arguments "input_names", "output_names", "dynamic_axes" in call to "export_onnx"  [call-arg]
rfdetr/fabric_module.py:460: error: Missing positional argument "input_names" in call to "onnx_simplify"  [call-arg]
rfdetr/fabric_module.py:460: error: Argument "onnx_dir" to "onnx_simplify" has incompatible type "Path"; expected "str"  [arg-type]
rfdetr/fabric_module.py:472: error: Incompatible types in assignment (expression has type "Optional[Any]", variable has type "device")  [assignment]
rfdetr/fabric_module.py:480: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:496: error: Incompatible types in assignment (expression has type "dict[Any, Any]", variable has type "ModelConfig")  [assignment]
rfdetr/fabric_module.py:518: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:525: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:528: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:535: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/fabric_module.py:538: error: Need type annotation for "sampler_train"  [var-annotated]
rfdetr/fabric_module.py:538: error: Argument 1 to "DistributedSampler" has incompatible type "Optional[Any]"; expected "Dataset[Any]"  [arg-type]
rfdetr/fabric_module.py:540: error: Incompatible types in assignment (expression has type "RandomSampler", variable has type "DistributedSampler[Any]")  [assignment]
rfdetr/fabric_module.py:540: error: Argument 1 to "RandomSampler" has incompatible type "Optional[Any]"; expected "Sized"  [arg-type]
rfdetr/fabric_module.py:547: error: Argument 1 to "DataLoader" has incompatible type "Optional[Any]"; expected "Dataset[Any]"  [arg-type]
rfdetr/fabric_module.py:557: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/fabric_module.py:560: error: Need type annotation for "sampler_val"  [var-annotated]
rfdetr/fabric_module.py:560: error: Argument 1 to "DistributedSampler" has incompatible type "Optional[Any]"; expected "Dataset[Any]"  [arg-type]
rfdetr/fabric_module.py:562: error: Incompatible types in assignment (expression has type "SequentialSampler", variable has type "DistributedSampler[Any]")  [assignment]
rfdetr/fabric_module.py:562: error: Argument 1 to "SequentialSampler" has incompatible type "Optional[Any]"; expected "Sized"  [arg-type]
rfdetr/fabric_module.py:565: error: Argument 1 to "DataLoader" has incompatible type "Optional[Any]"; expected "Dataset[Any]"  [arg-type]
rfdetr/fabric_module.py:578: error: Function is missing a type annotation  [no-untyped-def]
rfdetr/fabric_module.py:624: error: Call to untyped function "RFDETRFabricModule" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:625: error: Call to untyped function "RFDETRFabricData" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:628: error: Call to untyped function "setup" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:629: error: Call to untyped function "train_dataloader" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:630: error: Call to untyped function "val_dataloader" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:633: error: Call to untyped function "setup" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:636: error: Call to untyped function "get_coco_api_from_dataset" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:671: error: Call to untyped function "train_step" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:684: error: Call to untyped function "CocoEvaluator" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:692: error: Call to untyped function "validation_step" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:694: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:697: error: Call to untyped function "synchronize_between_processes" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:698: error: Call to untyped function "accumulate" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:699: error: Call to untyped function "summarize" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:727: error: Call to untyped function "state_dict" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:741: error: Call to untyped function "state_dict" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:755: error: Call to untyped function "state_dict" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:769: error: Call to untyped function "state_dict" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:778: error: Call to untyped function "export_model" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:802: error: Call to untyped function "CocoEvaluator" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:806: error: Call to untyped function "validation_step" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:807: error: Call to untyped function "update" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:809: error: Call to untyped function "synchronize_between_processes" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:810: error: Call to untyped function "accumulate" in typed context  [no-untyped-call]
rfdetr/fabric_module.py:811: error: Call to untyped function "summarize" in typed context  [no-untyped-call]
rfdetr/config_utils.py:24: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/config_utils.py:41: error: Incompatible types in assignment (expression has type "str", variable has type "Literal['cpu', 'cuda', 'mps']")  [assignment]
rfdetr/config_utils.py:54: error: Untyped decorator makes function "validate_resolution" untyped  [misc]
rfdetr/config_utils.py:64: error: Untyped decorator makes function "validate_training_dimensions" untyped  [misc]
rfdetr/config_utils.py:66: error: Function is missing a type annotation for one or more arguments  [no-untyped-def]
rfdetr/config_utils.py:76: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/config_utils.py:116: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/config_utils.py:126: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/config_utils.py:134: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/config_utils.py:138: error: Incompatible types in assignment (expression has type "str", variable has type "Literal['cpu', 'cuda', 'mps']")  [assignment]
rfdetr/config_utils.py:145: error: Class cannot subclass "BaseModel" (has type "Any")  [misc]
rfdetr/config_utils.py:154: error: Untyped decorator makes function "validate_config" untyped  [misc]
rfdetr/config_utils.py:170: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/config_utils.py:279: error: Returning Any from function declared to return "RFDETRConfig"  [no-any-return]
rfdetr/cli/main.py:17: error: Module "rfdetr" does not explicitly export attribute "RFDETRBase"  [attr-defined]
rfdetr/cli/main.py:20: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/cli/main.py:28: error: Statement is unreachable  [unreachable]
rfdetr/cli/main.py:38: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/cli/main.py:41: error: Call to untyped function "RFDETRBase" in typed context  [no-untyped-call]
rfdetr/cli/main.py:43: error: Call to untyped function "train" in typed context  [no-untyped-call]
rfdetr/cli/main.py:50: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/cli/main.py:51: error: Call to untyped function "RFDETRBase" in typed context  [no-untyped-call]
rfdetr/cli/main.py:52: error: Call to untyped function "train" in typed context  [no-untyped-call]
rfdetr/cli/main.py:59: error: Function is missing a return type annotation  [no-untyped-def]
rfdetr/cli/main.py:59: note: Use "-> None" if function does not return a value
rfdetr/cli/main.py:88: error: Call to untyped function "trainer" in typed context  [no-untyped-call]
tests/test_val_limit.py:38: error: Call to untyped function "to_args" in typed context  [no-untyped-call]
tests/test_val_limit.py:41: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_val_limit.py:46: error: Call to untyped function "to_args" in typed context  [no-untyped-call]
tests/test_val_limit.py:47: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_training_dimensions.py:43: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_quick_training.py:20: error: Module "rfdetr.models" does not explicitly export attribute "build_criterion_and_postprocessors"  [attr-defined]
tests/test_quick_training.py:20: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
tests/test_quick_training.py:51: error: "type[TestQuickTraining]" has no attribute "config_path"  [attr-defined]
tests/test_quick_training.py:52: error: "type[TestQuickTraining]" has no attribute "train_limit"  [attr-defined]
tests/test_quick_training.py:53: error: "type[TestQuickTraining]" has no attribute "val_limit"  [attr-defined]
tests/test_quick_training.py:54: error: "type[TestQuickTraining]" has no attribute "epochs"  [attr-defined]
tests/test_quick_training.py:55: error: "type[TestQuickTraining]" has no attribute "steps"  [attr-defined]
tests/test_quick_training.py:56: error: "type[TestQuickTraining]" has no attribute "validate"  [attr-defined]
tests/test_quick_training.py:61: error: "TestQuickTraining" has no attribute "config_path"  [attr-defined]
tests/test_quick_training.py:85: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
tests/test_quick_training.py:94: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
tests/test_quick_training.py:114: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_quick_training.py:120: error: "TestQuickTraining" has no attribute "train_limit"  [attr-defined]
tests/test_quick_training.py:134: error: Call to untyped function "ModelEma" in typed context  [no-untyped-call]
tests/test_quick_training.py:137: error: "TestQuickTraining" has no attribute "validate"  [attr-defined]
tests/test_quick_training.py:138: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
tests/test_quick_training.py:143: error: "TestQuickTraining" has no attribute "val_limit"  [attr-defined]
tests/test_quick_training.py:154: error: Call to untyped function "get_coco_api_from_dataset" in typed context  [no-untyped-call]
tests/test_quick_training.py:158: error: "TestQuickTraining" has no attribute "steps"  [attr-defined]
tests/test_quick_training.py:160: error: "TestQuickTraining" has no attribute "epochs"  [attr-defined]
tests/test_quick_training.py:209: error: Call to untyped function "step" in typed context  [no-untyped-call]
tests/test_quick_training.py:213: error: Call to untyped function "update" in typed context  [no-untyped-call]
tests/test_quick_training.py:233: error: Statement is unreachable  [unreachable]
tests/test_quick_training.py:236: error: "TestQuickTraining" has no attribute "validate"  [attr-defined]
tests/test_quick_training.py:241: error: Call to untyped function "evaluate" in typed context  [no-untyped-call]
tests/test_quick_training.py:292: error: Call to untyped function "parse_args" in typed context  [no-untyped-call]
tests/test_quick_training.py:296: error: "type[TestQuickTraining]" has no attribute "config_path"  [attr-defined]
tests/test_quick_training.py:297: error: "type[TestQuickTraining]" has no attribute "train_limit"  [attr-defined]
tests/test_quick_training.py:298: error: "type[TestQuickTraining]" has no attribute "val_limit"  [attr-defined]
tests/test_quick_training.py:299: error: "type[TestQuickTraining]" has no attribute "epochs"  [attr-defined]
tests/test_quick_training.py:300: error: "type[TestQuickTraining]" has no attribute "steps"  [attr-defined]
tests/test_quick_training.py:301: error: "type[TestQuickTraining]" has no attribute "validate"  [attr-defined]
tests/test_quick_training.py:304: error: Call to untyped function "setUpClass" of "TestQuickTraining" in typed context  [no-untyped-call]
tests/test_quick_training.py:305: error: Call to untyped function "test_quick_training" in typed context  [no-untyped-call]
tests/test_quick_training.py:309: error: Call to untyped function "main" in typed context  [no-untyped-call]
tests/test_model_construction.py:11: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
tests/test_model_construction.py:46: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
tests/test_model_construction.py:62: error: Call to untyped function "test_model_construction" in typed context  [no-untyped-call]
tests/test_fixed_size.py:13: error: Module "rfdetr.models" does not explicitly export attribute "build_criterion_and_postprocessors"  [attr-defined]
tests/test_fixed_size.py:13: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
tests/test_fixed_size.py:21: error: Missing type parameters for generic type "Dataset"  [type-arg]
tests/test_fixed_size.py:72: error: "type[TestFixedSize]" has no attribute "config_path"  [attr-defined]
tests/test_fixed_size.py:73: error: "type[TestFixedSize]" has no attribute "config"  [attr-defined]
tests/test_fixed_size.py:73: error: "type[TestFixedSize]" has no attribute "config_path"  [attr-defined]
tests/test_fixed_size.py:76: error: "type[TestFixedSize]" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:78: error: "type[TestFixedSize]" has no attribute "config"  [attr-defined]
tests/test_fixed_size.py:79: error: "type[TestFixedSize]" has no attribute "config"  [attr-defined]
tests/test_fixed_size.py:83: error: "type[TestFixedSize]" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:84: error: "type[TestFixedSize]" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:85: error: "type[TestFixedSize]" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:88: error: "type[TestFixedSize]" has no attribute "device"  [attr-defined]
tests/test_fixed_size.py:88: error: "type[TestFixedSize]" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:94: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
tests/test_fixed_size.py:94: error: "TestFixedSize" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:95: error: "TestFixedSize" has no attribute "device"  [attr-defined]
tests/test_fixed_size.py:109: error: Call to untyped function "FixedSizeDataset" in typed context  [no-untyped-call]
tests/test_fixed_size.py:110: error: "TestFixedSize" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:118: error: "TestFixedSize" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:123: error: "TestFixedSize" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:134: error: Call to untyped function "test_model_construction" in typed context  [no-untyped-call]
tests/test_fixed_size.py:135: error: Call to untyped function "test_fixed_size_dataset" in typed context  [no-untyped-call]
tests/test_fixed_size.py:138: error: "TestFixedSize" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:141: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
tests/test_fixed_size.py:141: error: "TestFixedSize" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:142: error: "TestFixedSize" has no attribute "device"  [attr-defined]
tests/test_fixed_size.py:145: error: "TestFixedSize" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:147: error: "TestFixedSize" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:154: error: "TestFixedSize" has no attribute "args"  [attr-defined]
tests/test_fixed_size.py:160: error: "TestFixedSize" has no attribute "device"  [attr-defined]
tests/test_fixed_size.py:161: error: "TestFixedSize" has no attribute "device"  [attr-defined]
tests/test_fixed_size.py:212: error: Call to untyped function "main" in typed context  [no-untyped-call]
test_evaluation.py:16: error: Function is missing a return type annotation  [no-untyped-def]
test_evaluation.py:16: note: Use "-> None" if function does not return a value
test_evaluation.py:22: error: Function is missing a return type annotation  [no-untyped-def]
test_evaluation.py:22: note: Use "-> None" if function does not return a value
test_evaluation.py:134: error: Call to untyped function "Args" in typed context  [no-untyped-call]
test_evaluation.py:142: error: Call to untyped function "RFDETRLightningModule" in typed context  [no-untyped-call]
test_evaluation.py:143: error: Call to untyped function "RFDETRDataModule" in typed context  [no-untyped-call]
test_evaluation.py:147: error: Call to untyped function "setup" in typed context  [no-untyped-call]
test_evaluation.py:179: error: Call to untyped function "main" in typed context  [no-untyped-call]
scripts/evaluate.py:24: error: Module "rfdetr.models" does not explicitly export attribute "build_criterion_and_postprocessors"  [attr-defined]
scripts/evaluate.py:24: error: Module "rfdetr.models" does not explicitly export attribute "build_model"  [attr-defined]
scripts/evaluate.py:88: error: Call to untyped function "MetricLogger" in typed context  [no-untyped-call]
scripts/evaluate.py:89: error: Call to untyped function "add_meter" in typed context  [no-untyped-call]
scripts/evaluate.py:89: error: Call to untyped function "SmoothedValue" in typed context  [no-untyped-call]
scripts/evaluate.py:93: error: Call to untyped function "CocoEvaluator" in typed context  [no-untyped-call]
scripts/evaluate.py:95: error: Call to untyped function "log_every" in typed context  [no-untyped-call]
scripts/evaluate.py:123: error: Call to untyped function "reduce_dict" in typed context  [no-untyped-call]
scripts/evaluate.py:128: error: Call to untyped function "update" in typed context  [no-untyped-call]
scripts/evaluate.py:133: error: Call to untyped function "update" in typed context  [no-untyped-call]
scripts/evaluate.py:140: error: Call to untyped function "update" in typed context  [no-untyped-call]
scripts/evaluate.py:143: error: Call to untyped function "synchronize_between_processes" in typed context  [no-untyped-call]
scripts/evaluate.py:146: error: Call to untyped function "synchronize_between_processes" in typed context  [no-untyped-call]
scripts/evaluate.py:150: error: Call to untyped function "accumulate" in typed context  [no-untyped-call]
scripts/evaluate.py:151: error: Call to untyped function "summarize" in typed context  [no-untyped-call]
scripts/evaluate.py:162: error: Call to untyped function "extract_per_class_metrics" in typed context  [no-untyped-call]
scripts/evaluate.py:242: error: Call to untyped function "to_args" in typed context  [no-untyped-call]
scripts/evaluate.py:273: error: Call to untyped function "build_model" in typed context  [no-untyped-call]
scripts/evaluate.py:282: error: Call to untyped function "build_criterion_and_postprocessors" in typed context  [no-untyped-call]
scripts/evaluate.py:286: error: Call to untyped function "build_dataset" in typed context  [no-untyped-call]
scripts/evaluate.py:298: error: Call to untyped function "get_coco_api_from_dataset" in typed context  [no-untyped-call]
scripts/evaluate.py:302: error: Call to untyped function "evaluate_with_per_class_metrics" in typed context  [no-untyped-call]
scripts/evaluate.py:363: error: Call to untyped function "get_args_parser" in typed context  [no-untyped-call]
scripts/evaluate.py:365: error: Call to untyped function "main" in typed context  [no-untyped-call]
scripts/train.py:90: error: Call to untyped function "RFDETRLightningModule" in typed context  [no-untyped-call]
scripts/train.py:91: error: Call to untyped function "RFDETRDataModule" in typed context  [no-untyped-call]
scripts/train.py:156: error: Call to untyped function "ONNXCheckpointHook" in typed context  [no-untyped-call]
scripts/train.py:266: error: Call to untyped function "get_sha" in typed context  [no-untyped-call]
scripts/train.py:274: error: Call to untyped function "main" in typed context  [no-untyped-call]
Found 1440 errors in 66 files (checked 84 source files)

bandit...................................................................